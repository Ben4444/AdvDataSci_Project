---
title: "Do Twitterstorms Reflect Real Storms? Locating Areas Impacted by Hurricane Harvey Through Analysis of Related Tweets"
author: "Ben Barrett"
date: "October 16, 2017"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
# Loading required packages
packages<-c("tibble","dplyr", "tidyr", "stringr", "jsonlite", "rdrop2", "data.table", "ggplot2", "maps", "ggmap", "gridExtra", "grid", "spatstat", "splancs", "maptools", "rgeos", "repmis", "RCurl", "rgdal")

for (i in packages){
  if(!require(i,character.only = T,quietly=T,warn.conflicts = F)){
    install.packages(i, repos = "http://cran.us.r-project.org")
  }
  require(i,character.only = T,quietly=T,warn.conflicts = F)
}
```

**Introduction**

Ever since its widespread introduction in the mid-2000s, social media has played a role in shaping the lives of individuals - with a notable influence in social capital acquisition (1), health and consumption-related actions (2; 3), and contemporarily, governmental elections and policy decisions. Given its far-reaching impact, social media has been utilized in natural disaster response, with a variety of platforms being used to assist in disaster relief coordination and information spread (4; 5). Beyond the benefit of boosting situational awareness among individuals experiencing a natural disaster "on the ground", social media output has been used to map natural disasters in real-time in order to assess the spread of damage (6), drawing upon the understanding that the content of social media is related to the proximity of a natural disaster - that is, the closer one is to a natural disaster, the more likely it is that social media output is related to that signficant event (7). This concept was recently put to use in the analysis of Twitter activity produced before, during, and after Hurricane Sandy, which found that the amount of hurricane-related tweets was associated with proximity to locations damaged by Sandy, and per-capita tweet frequency was strongly correlated with the extent of economic damage experienced by an area (8).

Building upon this established framework, this paper seeks to analyze Twitter data related to Hurricane Harvey, which struck Southeastern Texas as a Category 4 hurricane on August 25, 2017 and continued to travel up into Southern Louisiana, finally ending around September 1, 2017 (9). Geostatistical analyses will be performed to assess whether any clustering is present within the Hurricane Harvey Twitter data and identify areas that were hardest hit by the storm.

***

**Data and Methods**

*Data*

The Python library 'Tweepy' was used to connect to the Twitter Streaming API and download relevant tweets. The Python program, used to initiate the live stream was adapted from code provided by Mikael Brunila (10). The stream was set to search for the hashtags 'HurricaneHarvey' and 'HurricaneHarveyRelief', and was started at 9:10AM on 9/1/2017. The live tweet stream was stopped at 9:56AM on 9/4/2017, which resulted in a program run time of 36 hours, 46 minutes and a total of 3,289,336 KB (3.290 GB) of Twitter data collected. This corresponds to 1,491.086 KB of data per minute, on average. All of the output was saved as a JSON file, twitter_data.json, and stored in Dropbox.

```{r engine='python', highlight=TRUE, eval=FALSE, include=FALSE}
#twitter_streaming.py

#Import the necessary methods from tweepy library
import tweepy
from tweepy import Stream
from tweepy.streaming import StreamListener 
from tweepy import OAuthHandler
import json

#Variables that contains the user credentials to access Twitter API 
access_token = "Access_Token"
access_token_secret = "Access_Token_Secret"
consumer_key = "Consumer_Key"
consumer_secret = "Consumer_Secret"

auth = OAuthHandler(consumer_key, consumer_secret)
auth.set_access_token(access_token, access_token_secret)
 
api = tweepy.API(auth)
@classmethod
def parse(cls, api, raw):
    status = cls.first_parse(api, raw)
    setattr(status, 'json', json.dumps(raw))
    return status
 
# Status() is the data model for a tweet
tweepy.models.Status.first_parse = tweepy.models.Status.parse
tweepy.models.Status.parse = parse
class MyListener(StreamListener):

     def on_data(self, data):
        try:
            with open('twitter_data.json', 'a') as f:
                f.write(data)
                return True
        except BaseException as e:
            print("Error on_data: %s" % str(e))
        return True
 
     def on_error(self, status):
        print(status)
        return True
 
#Set the hashtag to be searched
twitter_stream = Stream(auth, MyListener())
twitter_stream.filter(track=['HurricaneHarvey', 'HurricaneHarveyRelief'])
```

Because of the large data file size, the twitter_data.json file was first streamed into R with the R packages jsonlite (11) and rdrop2 (12), using a handler to randomly sample 25% of each page of JSON lines (total run time = 1.5 hours). The import procedure found 420,294 records, each corresponding to a tweet collected during the Twitter live stream. The random sample yielded a study dataset of 22,689 tweets.

```{r, eval=FALSE, include=FALSE}
install.packages("jsonlite")
install.packages("rdrop2")
install.packages("tibble")
library(jsonlite)
library(rdrop2)
library(tibble)

# Setting up the Dropbox authentication
token <- drop_auth()
saveRDS(token, "~/Advanced Data Science I/AdvDataSci_Project/.gitignore.httr-oauth.RDS")
drop_auth(rdstoken= "~/Advanced Data Science I/AdvDataSci_Project/.gitignore.httr-oauth.RDS")
drop_share("twitter_data.json")

# Streaming in Twitter data
con_in <- url("https://www.dropbox.com/s/0rubxdgwvt9od66/twitter_data.json?dl=1")
con_out <- file(tmp <- tempfile(), open = "wb")
set.seed(4)
stream_in(con_in, handler= function(randsam){
  randsam <- randsam[sample(1:nrow(randsam), round(0.25*length(randsam))),]
  stream_out(randsam, con_out, pagesize=1000)
}, pagesize=500, verbose=TRUE)
close(con_out)

tweets <- stream_in(file(tmp))
nrow(tweets)
unlink(tmp)

# Flattening and saving the streamed in data
tweets_flat <- flatten(tweets)
tweets_tbl <- as_data_frame(tweets_flat)
saveRDS(tweets_tbl, "tweets_tbl.rds")
saveRDS(tweets_flat, "tweets_flat.rds")

# Creating a dataframe with only the non-missing location variables of interest remaining, excluding coordinates for now
locations <- data.frame(tweets_flat$created_at, tweets_flat$user.id, tweets_flat$user.name, tweets_flat$user.screen_name, tweets_flat$user.location, tweets_flat$place.name, tweets_flat$place.full_name, tweets_flat$place.country_code, tweets_flat$place.country)
locations_notmiss <- locations[!with(locations,is.na(locations[, 5:9])), ]
locations_clean <- locations_notmiss[rowSums(is.na(locations_notmiss))!=ncol(locations_notmiss), ]
colnames(locations_clean) <- c("creation_time", "user_id", "user_name", "user_screen_name", "user_location", "place_name", "place_full_name", "place_country_code", "place_country")

# Subsetting the dataframe to only tweets with geographic coordinates linked
forunnest <- subset(tweets_flat, (!is.na(tweets_flat$coordinates.type)))
unnested <- unnest(forunnest, geo.coordinates)
coordinates <- data.frame(unnested$user.id, unnested$user.name, unnested$geo.coordinates, unnested$coordinates.type)

# Pulling out separate dataframes for tweet latitude and longitude
coordinates$count <- ave(coordinates$unnested.geo.coordinates, coordinates$unnested.user.name, FUN=seq_along)
latitude <- coordinates[which(coordinates$count == 1), ]
latitude$count <- NULL
colnames(latitude) <- c("user_id", "user_name", "latitude", "coordinates_type")
longitude <- coordinates[which(coordinates$count == 2), ]
longitude$count <- NULL
colnames(longitude) <- c("user_id", "user_name", "longitude", "coordinates_type")

# Merging the tweet latitude and longitude dataframes
coords_full <- merge(latitude, longitude, by=c("user_id", "user_name", "coordinates_type"))

# Merging the tweet place and user locations dataframe with the full coordinates dataframe
all_locations <- merge(locations_clean, coords_full, by=c("user_id", "user_name"), all.x=TRUE)

# Note: Coordinates (latitude, longitude) and all place_ variables correspond to the location of the tweet itself. The user_location variable corresponds to the location the user first entered when they signed up for Twitter. Therefore, coordinates will be used for location data first. Then, place_ variables will be drawn from. Finally, I will pull from user_location.

# Saving the data file to be used for analysis. Processing above had to be done in order to allow for the datafile to be saved as a CSV. This CSV file was then saved in my Dropbox.
write.csv(all_locations, file="all_locations.csv")
```

```{r, results="hide", echo=FALSE, message=FALSE, warning=FALSE}
###
# Beginning reproducible research here, for time's sake. All the above should be fully reproducible, however, if one so desired.
###

# Loading in the saved CSV file
#drop_share("all_locations.csv")
download.file("https://www.dropbox.com/s/5uvgo2rqekok0fn/all_locations.csv?dl=1",
             destfile = "all_locations.csv")
all_locations <- read.csv("all_locations.csv")
all_locations$X <- NULL

# Only keeping tweet place entries that are from the United States
all_locations_us <- subset(all_locations, place_country=='United States' | is.na(place_country))

# Splitting the full name of the tweet place entry into city and state columns
setDT(all_locations_us)
all_locations_us[, c("city", "state") := tstrsplit(place_full_name, ", ", fixed=TRUE)]
all_locations_us <- as.data.frame(all_locations_us)

# Only keeping the states that were directly impacted by Hurricane Harvey: Texas and Louisiana (as well some other weirdly coded state observations, which I will deal with later)
all_locations_txla <- subset(all_locations_us, state=='LA' | state=='TX' | state=='Austin' | state=='USA' | is.na(state))

# Recoding the Austin tweet place state observation into city = Austin, state = TX
table(all_locations_txla$city, all_locations_txla$state)
all_locations_txla$city[all_locations_txla$city == "Downtown"] <- "Austin"
all_locations_txla$state[all_locations_txla$state == "Austin"] <- "TX"

# Removing the USA tweet place state observations that do not have a city observation corresponding to Texas or Louisiana
all_locations_txla <- subset(all_locations_txla, state=='LA' | state=='TX' | (state=='USA' & city=='Louisiana') | (state=='USA' & city=='Texas') | is.na(state))

# Recoding the USA tweet place state observations into city = "", state = TX or LA
all_locations_txla$state[all_locations_txla$city == "Texas"] <- "TX"
all_locations_txla$city[all_locations_txla$city == "Texas"] <- ""
all_locations_txla$state[all_locations_txla$city == "Louisiana"] <- "LA"
all_locations_txla$city[all_locations_txla$city == "Louisiana"] <- ""

# Finally, removing odd city tweet places that did not have states associated with them
all_locations_txla <- subset(all_locations_txla, city != 'Columbia Edgewater  Country Club' & city != 'Dell Diamond' & city != 'George R. Brown Convention Center' & city != 'Goobertown' & city != 'Kroger Marketplace' & city != 'Local Foods' & city != 'Nashville TN' & city != 'Sagemont' & city != 'The Nest - A Breakfast Joint' & city != 'United States' & city != 'University of Tulsa' & city != 'West County Center' | is.na(city))

# Next, I am splitting the user locations into three columns using a splitter of ", " and " ". I will only be pulling user locations that are entered in a relatively traditional format
setDT(all_locations_txla)
all_locations_txla[, c("user_city_comma", "user_state_comma", "user_country_comma", "extra_1", "extra_2", "extra_3", "extra_4") := tstrsplit(user_location, ", ", fixed=TRUE)]
all_locations_txla$extra_1 <- NULL
all_locations_txla$extra_2 <- NULL
all_locations_txla$extra_3 <- NULL
all_locations_txla$extra_4 <- NULL
all_locations_txla[, c("user_city_space", "user_state_space", "user_country_space", "extra_1", "extra_2", "extra_3", "extra_4", "extra_5", "extra_6", "extra_7", "extra_8", "extra_9", "extra_10", "extra_11", "extra_12", "extra_13", "extra_14", "extra_15", "extra_16", "extra_17", "extra_18", "extra_19", "extra_20", "extra_21", "extra_22", "extra_23", "extra_24", "extra_25", "extra_26", "extra_27", "extra_28", "extra_29", "extra_30", "extra_31", "extra_32", "extra_33", "extra_34", "extra_35", "extra_36") := tstrsplit(user_location, " ", fixed=TRUE)]
all_locations_txla$extra_1 <- NULL
all_locations_txla$extra_2 <- NULL
all_locations_txla$extra_3 <- NULL
all_locations_txla$extra_4 <- NULL
all_locations_txla$extra_5 <- NULL
all_locations_txla$extra_6 <- NULL
all_locations_txla$extra_7 <- NULL
all_locations_txla$extra_8 <- NULL
all_locations_txla$extra_9 <- NULL
all_locations_txla$extra_10 <- NULL
all_locations_txla$extra_11 <- NULL
all_locations_txla$extra_12 <- NULL
all_locations_txla$extra_13 <- NULL
all_locations_txla$extra_14 <- NULL
all_locations_txla$extra_15 <- NULL
all_locations_txla$extra_16 <- NULL
all_locations_txla$extra_17 <- NULL
all_locations_txla$extra_18 <- NULL
all_locations_txla$extra_19 <- NULL
all_locations_txla$extra_20 <- NULL
all_locations_txla$extra_21 <- NULL
all_locations_txla$extra_22 <- NULL
all_locations_txla$extra_23 <- NULL
all_locations_txla$extra_24 <- NULL
all_locations_txla$extra_25 <- NULL
all_locations_txla$extra_26 <- NULL
all_locations_txla$extra_27 <- NULL
all_locations_txla$extra_28 <- NULL
all_locations_txla$extra_29 <- NULL
all_locations_txla$extra_30 <- NULL
all_locations_txla$extra_31 <- NULL
all_locations_txla$extra_32 <- NULL
all_locations_txla$extra_33 <- NULL
all_locations_txla$extra_34 <- NULL
all_locations_txla$extra_35 <- NULL
all_locations_txla$extra_36 <- NULL
all_locations_txla <- as.data.frame(all_locations_txla)

# Now I am selecting the user locations within the states of interest or those that represent coordinates
all_locations_txla <- subset(all_locations_txla, user_city_comma=='Texas' | user_city_comma=='TX' | user_city_comma=='Louisiana' | user_city_comma=='LA' | user_state_comma=='Texas' | user_state_comma=='TX' | user_state_comma=='Louisiana' | user_state_comma=='LA' | user_country_comma=='Texas' | user_country_comma=='TX' | user_country_comma=='Louisiana' | user_country_comma=='LA' | user_city_space=='Texas' | user_city_space=='TX' | user_city_space=='Louisiana' | user_city_space=='LA' | user_state_space=='Texas' | user_state_space=='TX' | user_state_space=='Louisiana' | user_state_space=='LA' | user_country_space=='Texas' | user_country_space=='TX' | user_country_space=='Louisiana' | user_country_space=='LA' | user_city_space=='iPhone:' | user_city_space=='ÜT:' | state=='TX' | state=='LA' | latitude =='30.26996' | longitude=='-97.73604')

# Reassigning variable values to create concatenated user city and state variables
table(all_locations_txla$user_city_comma)
all_locations_txla$user_city[all_locations_txla$user_city_comma == " Dallas"] <- "Dallas"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Abilene"] <- "Abilene"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Alief Houston"] <- "Alief, Houston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Alvin"] <- "Alvin"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Amarillo"] <- "Amarillo"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Amarillo Texas"] <- "Amarillo"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Argyle"] <- "Argyle"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Arlington"] <- "Arlington"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Austin"] <- "Austin"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Austin | Texas"] <- "Austin"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Austin Texas"] <- "Austin"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Austin Texas 'merica"] <- "Austin"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Austin TX "] <- "Austin"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Austin,Tx (home) LA"] <- "Austin"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Austin. TX"] <- "Austin"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "AVID Center - Dallas"] <- "Dallas"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "B/CS Texas"] <- "Bryan-College Station"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Baton Rouge"] <- "Baton Rouge"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Baytown"] <- "Baytown"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Beaumont"] <- "Beaumont"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Bedford"] <- "Bedford"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Bee Cave"] <- "Bee Cave"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Belton"] <- "Belton"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Big Spring"] <- "Big Spring"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Boerne"] <- "Boerne"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "BR"] <- "Baton Rouge"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Bridge City"] <- "Bridge City"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Brownsville"] <- "Brownsville"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Bryan"] <- "Bryan"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Buda"] <- "Buda"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Bulverde"] <- "Bulverde"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Burleson"] <- "Burleson"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Canyon"] <- "Canyon"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Carrollton"] <- "Carrollton"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Cedar Park"] <- "Cedar Park"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Celeste"] <- "Celeste"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Central City"] <- "Central City"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Chateau Woods"] <- "Chateau Woods"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Cinco Ranch"] <- "Cinco Ranch"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Cleburne"] <- "Cleburne"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Cloverleaf"] <- "Cloverleaf"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "College Station"] <- "College Station"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Collin County"] <- "Collin County"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Columbia"] <- "Columbia"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Commerce"] <- "Commerce"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Conroe"] <- "Conroe"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Coppell"] <- "Coppell"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Copperas Cove TX"] <- "Copperas Cove"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Corpus Christi"] <- "Corpus Christi"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Covington"] <- "Covington"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Crosstimbers"] <- "Crosstimbers"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Cut-N-Shoot"] <- "Cut and Shoot"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Cut and Shoot"] <- "Cut and Shoot"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Cypress"] <- "Cypress"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Cypress Texas"] <- "Cypress"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Dalhart"] <- "Dalhart"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Dallas"] <- "Dallas"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Dallas Texas"] <- "Dallas"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Dallas TX"] <- "Dallas"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Dayton"] <- "Dayton"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Deer Park"] <- "Deer Park"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Del Rio"] <- "Del Rio"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Denham Springs"] <- "Denham Springs"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Denton"] <- "Denton"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "DeRidder"] <- "DeRidder"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Desoto"] <- "Desoto"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Dickinson"] <- "Dickinson"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Dickinson Texas"] <- "Dickinson"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Edinburg"] <- "Edinburg"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "El Paso"] <- "El Paso"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Elgin"] <- "Elgin"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Flower Mound"] <- "Flower Mound"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Fort Worth"] <- "Fort Worth"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Fredericksburg"] <- "Fredericksburg"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Friendswood"] <- "Friendswood"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Frisco"] <- "Frisco"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Frisco Texas"] <- "Frisco"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Fulshear"] <- "Fulshear"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Galveston"] <- "Galveston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Galveston Island"] <- "Galveston Island"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Galveston Island TX"] <- "Galveston Island"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Garland"] <- "Garland"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Georgetown"] <- "Georgetown"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Gladewater"] <- "Gladewater"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Golden TX"] <- "Golden"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "GP"] <- "Grand Prairie"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Granbury"] <- "Granbury"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Grand Cane"] <- "Grand Cane"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Grand Prairie"] <- "Grand Prairie"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Grapevine"] <- "Grapevine"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Hammond"] <- "Hammond"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Harlingen"] <- "Harlingen"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Hawkins"] <- "Hawkins"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Heath"] <- "Heath"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Helotes"] <- "Helotes"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Hideaway"] <- "Hideaway"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Highlands"] <- "Highlands"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Homestead"] <- "Homestead"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Houma"] <- "Houma"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "houston"] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Houston"] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "HOUSTON"] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Houston-ish"] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Houston Galleria area"] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Houston Texas"] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Houston Texas "] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Houston Texas USA"] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Houston TX"] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "HOUSTON TX"] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Houston TX 77079"] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Houston via Boston "] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Houston(ish) "] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Houston,TX"] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "HQ in San Antonio"] <- "San Antonio"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "htx"] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Huffman"] <- "Huffman"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Humble"] <- "Humble"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Huntsville"] <- "Huntsville"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Hurst"] <- "Hurst"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Ingleside"] <- "Ingleside"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Irving"] <- "Irving"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Jasper"] <- "Jasper"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Katy"] <- "Katy"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Kemah"] <- "Kemah"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Killeen"] <- "Killeen"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Kingsville"] <- "Kingsville"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Kingwood"] <- "Kingwood"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Kirbyville"] <- "Kirbyville"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Klein"] <- "Klein"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Krum"] <- "Krum"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "La Grange"] <- "La Grange"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "La Villa"] <- "La Villa"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Labelle Texas"] <- "Labelle"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Lafayetta"] <- "Lafayette"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Lafayette"] <- "Lafayette"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Lake Charles"] <- "Lake Charles"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Laredo"] <- "Laredo"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "League City"] <- "League City"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Lewisville"] <- "Lewisville"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Live Oak"] <- "Live Oak"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Llano"] <- "Llano"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Longview"] <- "Longview"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Lorena"] <- "Lorena"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Lubbock"] <- "Lubbock"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Lufkin"] <- "Lufkin"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Lumberton"] <- "Lumberton"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Mabank"] <- "Mabank"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Madisonville"] <- "Madisonville"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Madisonville LA"] <- "Madisonville"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Marble Falls"] <- "Marble Falls"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "McAllen"] <- "McAllen"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "McKinney"] <- "McKinney"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Merit"] <- "Merit"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Mesquite"] <- "Mesquite"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Metairie"] <- "Metairie"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Miami Beach"] <- "Miami Beach"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Midland"] <- "Midland"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Midlothian"] <- "Midlothian"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Missouri City"] <- "Missouri City"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Mo City"] <- "Missouri City"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Monroe"] <- "Monroe"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Nacogdoches"] <- "Nacogdoches"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Natchitoches"] <- "Natchitoches"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Navasota"] <- "Navasota"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "NAWFSIDE HOUSTON TX"] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "near Austin"] <- "Austin"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Near Austin Texas"] <- "Austin"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Nederland"] <- "Nederland"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "New Braunfels"] <- "New Braunfels"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "New Caney"] <- "New Caney"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "New Orleans"] <- "New Orleans"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "New Orleans (Mandeville)"] <- "New Orleans"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "North Cleveland"] <- "North Cleveland"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "North Richland Hills"] <- "North Richland Hills"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Odessa"] <- "Odessa"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Orange"] <- "Orange"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Palmer"] <- "Palmer"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Paradise"] <- "Paradise"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Pasadena"] <- "Pasadena"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Pearland"] <- "Pearland"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Pecos"] <- "Pecos"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Pflugerville"] <- "Pflugerville"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Piney Woods"] <- "Piney Woods"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Plano"] <- "Plano"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Port Aransas"] <- "Port Aransas"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Port Arthur"] <- "Port Arthur"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Port Arthur Texas"] <- "Port Arthur"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Port Neches"] <- "Port Neches"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Prairie View"] <- "Prairie View"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Quitman Louisiana "] <- "Quitman"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Richardson"] <- "Richardson"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Richmond"] <- "Richmond"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Rockport"] <- "Rockport"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Rockwall"] <- "Rockwall"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Round Rock"] <- "Round Rock"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Rowlett"] <- "Rowlett"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Rusk"] <- "Rusk"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "SA"] <- "San Antonio"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Sa TX"] <- "San Antonio"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "SA TX"] <- "San Antonio"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Sabine Pass"] <- "Sabine Pass"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Saginaw Texas"] <- "Saginaw"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "San Antonio"] <- "San Antonio"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "San Antonio Texas"] <- "San Antonio"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "San Antonio Texas "] <- "San Antonio"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "San Antonio TX"] <- "San Antonio"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "San Marcos"] <- "San Marcos"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Santa Fe Texas"] <- "Santa Fe"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Schertz"] <- "Schertz"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "SCREWSTON"] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Sherman"] <- "Sherman"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Shoreacres"] <- "Shoreacres"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Shreveport"] <- "Shreveport"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Sinton"] <- "Sinton"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Slidell"] <- "Slidell"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Spring"] <- "Spring"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Spring Branch"] <- "Spring Branch"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Stagecoach"] <- "Stagecoach"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Stone Oak"] <- "Stone Oak"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Sugar Land"] <- "Sugar Land"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Sweeny"] <- "Sweeny"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Tallulah"] <- "Tallulah"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Temple"] <- "Temple"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Terrell "] <- "Terrell"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Texas A&M University"] <- "Texas A&M University"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "The Woodlands"] <- "The Woodlands"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Tomball"] <- "Tomball"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Troy"] <- "Troy"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Tyler"] <- "Tyler"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Tyler Texas"] <- "Tyler"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "University Park"] <- "University Park"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Victoria"] <- "Victoria"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Vidor"] <- "Vidor"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Vinton"] <- "Vinton"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Waco"] <- "Waco"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Warren"] <- "Warren"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Washington"] <- "Washington"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Watauga"] <- "Watauga"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Waxahachie"] <- "Waxahachie"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Weslaco"] <- "Weslaco"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "West Monroe"] <- "West Monroe"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "West University Place"] <- "West University Place"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Winnsboro"] <- "Winnsboro"
all_locations_txla$user_city[all_locations_txla$user_city_comma == "Wylie"] <- "Wylie"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Louisiana"] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_city_comma == " Texas"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Austin,Tx (home) LA"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Houston,TX"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "LA"] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_city_comma == " Louisiana"] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Louisiana "] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Lovely in Louisiana"] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "On the Texas #TrumpTrain "] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Texas"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Texas "] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Texas #ProudAmerican #MAGA"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Texas | IG @daniyal_themenace "] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Texas A&M University"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Texas Bernie Progressive"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Texas bitch"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Texas Est. 1836"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Texas Forever - USA Always "] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "texas forever."] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Texas Gulf Coast"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Texas Gulf Coast "] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Texas Hill Country"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Texas Island"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Texas Panhandle"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Texas USA"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "Texas West of the Pecos"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "the greatest state...Texas"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "The Texas Coastal Bend"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "TX"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_comma == "TX Borderlands"] <- "TX"

table(all_locations_txla$user_state_comma)
all_locations_txla$user_state[all_locations_txla$user_state_comma == "Houston"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "Houston Texas"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "La"] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "LA"] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "LA ..Born June 4 "] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "Louisiana"] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "Louisiana "] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "North Texas"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "Ste 1060\nDallas"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "Texas"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "Texas "] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "Texas \\m/"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "Texas 75077"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "Texas 75251"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "Texas USA"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "the last Stand"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "The Lone Star State"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "TX"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "TX "] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "TX - Dallas"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "TX (Austin burb)"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "TX (we$t side)"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "TX / Houston "] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "TX / San Antonio "] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == " TX → Dallas"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "  TX ☀️"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "TX T-0802"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "TX USA"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "TX USA\n"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "TX,"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_comma == "TX|Stephenville"] <- "TX"
all_locations_txla$user_city[all_locations_txla$user_state_comma == "Houston"] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_state_comma == "Houston Texas"] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_state_comma == "Ste 1060\nDallas"] <- "Dallas"
all_locations_txla$user_city[all_locations_txla$user_state_comma == "Texas 75077"] <- "Denton County"
all_locations_txla$user_city[all_locations_txla$user_state_comma == "Texas 75251"] <- "Dallas"
all_locations_txla$user_city[all_locations_txla$user_state_comma == "TX - Dallas"] <- "Dallas"
all_locations_txla$user_city[all_locations_txla$user_state_comma == "TX (Austin burb)"] <- "Austin"
all_locations_txla$user_city[all_locations_txla$user_state_comma == "TX / Houston "] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_state_comma == "TX / San Antonio "] <- "San Antonio"
all_locations_txla$user_city[all_locations_txla$user_state_comma == " TX → Dallas"] <- "Dallas"
all_locations_txla$user_city[all_locations_txla$user_state_comma == "TX|Stephenville"] <- "Stephenville"

table(all_locations_txla$user_country_comma)
all_locations_txla$user_state[all_locations_txla$user_country_comma == "Texas"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_country_comma == "TX"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_country_comma == "TX "] <- "TX"

table(all_locations_txla$user_city_comma)
table(all_locations_txla$user_city_space)
all_locations_txla$user_city[all_locations_txla$user_city_space == "Willis"] <- "Willis"
all_locations_txla$user_state[all_locations_txla$user_city_space == "LA"] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_city_space == "Louisiana"] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_city_space == "Texas"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_city_space == "TX"] <- "TX"

table(all_locations_txla$user_state_space)
all_locations_txla$user_state[all_locations_txla$user_state_space == "La"] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_state_space == "LA"] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_state_space == "LA,"] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_state_space == "Louisiana"] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_state_space == "Louisiana,"] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_state_space == "Texas"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_space == "Texas,"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_space == "TX"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_state_space == "TX,"] <- "TX"
all_locations_txla$user_city[all_locations_txla$user_state_space == "Arthur"] <- "Port Arthur"
all_locations_txla$user_city[all_locations_txla$user_state_space == "Austin"] <- "Austin"
all_locations_txla$user_city[all_locations_txla$user_state_space == "Houston"] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_state_space == "HOUSTON"] <- "Houston"
all_locations_txla$user_city[all_locations_txla$user_state_space == "Preston"] <- "Preston"
all_locations_txla$user_city[all_locations_txla$user_state_space == "Richland"] <- "Richland"

table(all_locations_txla$user_country_space)
all_locations_txla$user_state[all_locations_txla$user_country_space == "LA"] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_country_space == "LA,"] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_country_space == "Louisiana"] <- "LA"
all_locations_txla$user_state[all_locations_txla$user_country_space == "Texas"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_country_space == "Texas,"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_country_space == "TX"] <- "TX"
all_locations_txla$user_state[all_locations_txla$user_country_space == "TX,"] <- "TX"

# Extracting the user locations set as geographic coordinates
setDT(all_locations_txla)
all_locations_txla[, c("user_latitude", "user_longitude") := tstrsplit(user_state_space, ",", fixed=TRUE)]
all_locations_txla <- as.data.frame(all_locations_txla)
all_locations_txla$user_latitude[is.na(all_locations_txla$user_longitude)] <- NA

# Removing variables I no longer need 
all_locations_txla$user_city_comma <- NULL
all_locations_txla$user_state_comma <- NULL
all_locations_txla$user_country_comma <- NULL
all_locations_txla$user_city_space <- NULL
all_locations_txla$user_state_space <- NULL
all_locations_txla$user_country_space <- NULL

# Creating placeholder values for a tweet or user city if that observation had a state name assigned but no city name
all_locations_txla$city[all_locations_txla$state == "TX" & is.na(all_locations_txla$city)] <- ""
all_locations_txla$city[all_locations_txla$state == "LA" & is.na(all_locations_txla$city)] <- ""
all_locations_txla$user_city[all_locations_txla$user_state == "TX" & is.na(all_locations_txla$user_city)] <- ""
all_locations_txla$user_city[all_locations_txla$user_state == "LA" & is.na(all_locations_txla$user_city)] <- ""

# Removing observations that have a missing tweet and user city, and do not have tweet or user geographic coordinates available
all_locations_txla$null <- NA
all_locations_txla$latitude <- as.numeric(all_locations_txla$latitude)
all_locations_txla$user_latitude <- as.numeric(all_locations_txla$user_latitude)
all_locations_txla$latitude <- rowSums(all_locations_txla[,c("latitude", "null")], na.rm=TRUE)
all_locations_txla$user_latitude <- rowSums(all_locations_txla[,c("user_latitude", "null")], na.rm=TRUE)
all_locations_txla <- subset(all_locations_txla, city != "" | user_city != "" | latitude != 0 | user_latitude != 0)
all_locations_txla$latitude[all_locations_txla$latitude == 0] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 0] <- NA

# Imputing tweet location geographic coordinates
table(all_locations_txla$city, all_locations_txla$state)
all_locations_txla$place_latitude <- ave(all_locations_txla$state, all_locations_txla$city, FUN=seq_along)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Austin"] <- runif(1, 30.129461, 30.517089)
set.seed(2)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 2 & all_locations_txla$city=="Austin"] <- runif(1, 30.129461, 30.517089)
set.seed(3)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 3 & all_locations_txla$city=="Austin"] <- runif(1, 30.129461, 30.517089)
set.seed(4)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 4 & all_locations_txla$city=="Austin"] <- runif(1, 30.129461, 30.517089)
set.seed(5)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 5 & all_locations_txla$city=="Austin"] <- runif(1, 30.129461, 30.517089)
set.seed(6)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 6 & all_locations_txla$city=="Austin"] <- runif(1, 30.129461, 30.517089)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Avondale"] <- runif(1, 32.967, 32.968)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Baton Rouge"] <- runif(1, 30.324707, 30.559725)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Buda"] <- runif(1, 30.064542, 30.113557)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="College Station"] <- runif(1, 30.523721, 30.657601)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Corpus Christi"] <- runif(1, 27.558603, 27.881972)
set.seed(2)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 2 & all_locations_txla$city=="Corpus Christi"] <- runif(1, 27.558603, 27.881972)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Dallas"] <- runif(1, 32.620473, 33.012874)
set.seed(2)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 2 & all_locations_txla$city=="Dallas"] <- runif(1, 32.620473, 33.012874)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Desoto"] <- runif(1, 32.565084, 32.647654)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Dickinson"] <- runif(1, 29.425408, 29.477426)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Frisco"] <- runif(1, 33.081519, 33.219348)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Galveston"] <- runif(1, 29.083297, 29.351776)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Greatwood"] <- runif(1, 29.540520, 29.565905)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(2)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 2 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(3)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 3 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(4)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 4 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(5)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 5 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(6)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 6 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(7)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 7 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(8)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 8 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(9)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 9 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(10)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 10 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(11)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 11 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(12)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 12 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(13)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 13 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(14)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 14 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(15)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 15 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(16)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 16 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(17)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 17 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(18)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 18 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(19)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 19 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(20)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 20 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(21)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 21 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(22)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 22 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(23)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 23 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(24)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 24 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(25)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 25 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(26)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 26 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(27)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 27 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(28)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 28 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(29)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 29 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(30)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 30 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(31)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 31 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(32)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 32 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(33)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 33 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(34)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 34 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(35)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 35 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(36)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 36 & all_locations_txla$city=="Houston"] <- runif(1, 29.542464, 30.105995)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Humble"] <- runif(1, 29.954359, 30.032412)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Ingleside"] <- runif(1, 27.821463, 27.912061)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Jersey Village"] <- runif(1, 29.872683, 29.906765)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Lake Jackson"] <- runif(1, 28.975529, 29.120832)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Lakeway"] <- runif(1, 30.318157, 30.385409)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Madisonville"] <- runif(1, 30.381680, 30.420027)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Mandeville"] <- runif(1, 30.348441, 30.404274)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Midland"] <- runif(1, 31.927002, 32.131327)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="New Orleans"] <- runif(1, 29.869312, 30.174301)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Nolanville"] <- runif(1, 31.066966, 31.089755)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Oak Ridge North"] <- runif(1, 30.143619, 30.169594)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Odessa"] <- runif(1, 31.799299, 31.954692)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Pearland"] <- runif(1, 29.501570, 29.597741)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Port Arthur"] <- runif(1, 29.679602, 30.032146)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Richardson"] <- runif(1, 32.923345, 33.004288)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Richmond"] <- runif(1, 29.554957, 29.610640)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Richwood"] <- runif(1, 32.437411, 32.484195)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Roanoke"] <- runif(1, 32.986932, 33.031125)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Round Rock"] <- runif(1, 30.469057, 30.577301)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="San Antonio"] <- runif(1, 29.228579, 29.737837)
set.seed(2)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 2 & all_locations_txla$city=="San Antonio"] <- runif(1, 29.228579, 29.737837)
set.seed(3)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 3 & all_locations_txla$city=="San Antonio"] <- runif(1, 29.228579, 29.737837)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Sienna Plantation"] <- runif(1, 29.451771, 29.510349)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Sugar Land"] <- runif(1, 29.511887, 29.661464)
set.seed(1)
all_locations_txla$place_latitude[all_locations_txla$place_latitude == 1 & all_locations_txla$city=="Temple"] <- runif(1, 31.029838, 31.177114)
all_locations_txla$place_longitude <- ave(all_locations_txla$state, all_locations_txla$city, FUN=seq_along)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Austin"] <- runif(1, -97.936090, -97.580408)
set.seed(2)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 2 & all_locations_txla$city=="Austin"] <- runif(1, -97.936090, -97.580408)
set.seed(3)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 3 & all_locations_txla$city=="Austin"] <- runif(1, -97.936090, -97.580408)
set.seed(4)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 4 & all_locations_txla$city=="Austin"] <- runif(1, -97.936090, -97.580408)
set.seed(5)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 5 & all_locations_txla$city=="Austin"] <- runif(1, -97.936090, -97.580408)
set.seed(6)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 6 & all_locations_txla$city=="Austin"] <- runif(1, -97.936090, -97.580408)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Avondale"] <- runif(1, -97.421, -97.420)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Baton Rouge"] <- runif(1, -91.215799, -91.002252)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Buda"] <- runif(1, -97.872263, -97.810980)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="College Station"] <- runif(1, -96.386077, -96.196907)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Corpus Christi"] <- runif(1, -97.682740, -97.094971)
set.seed(2)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 2 & all_locations_txla$city=="Corpus Christi"] <- runif(1, -97.682740, -97.094971)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Dallas"] <- runif(1, -96.992508, -96.557174)
set.seed(2)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 2 & all_locations_txla$city=="Dallas"] <- runif(1, -96.992508, -96.557174)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Desoto"] <- runif(1, -96.908390, -96.822559)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Dickinson"] <- runif(1, -95.109664, -95.009929)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Frisco"] <- runif(1, -96.922558, -96.733387)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Galveston"] <- runif(1, -95.122330, -94.731875)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Greatwood"] <- runif(1, -95.696933, -95.647666)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(2)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 2 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(3)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 3 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(4)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 4 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(5)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 5 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(6)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 6 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(7)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 7 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(8)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 8 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(9)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 9 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(10)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 10 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(11)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 11 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(12)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 12 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(13)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 13 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(14)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 14 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(15)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 15 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(16)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 16 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(17)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 17 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(18)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 18 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(19)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 19 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(20)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 20 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(21)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 21 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(22)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 22 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(23)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 23 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(24)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 24 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(25)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 25 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(26)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 26 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(27)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 27 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(28)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 28 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(29)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 29 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(30)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 30 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(31)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 31 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(32)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 32 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(33)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 33 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(34)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 34 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(35)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 35 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(36)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 36 & all_locations_txla$city=="Houston"] <- runif(1, -95.786337, -95.079983)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Humble"] <- runif(1, -95.284061, -95.243893)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Ingleside"] <- runif(1, -97.242802, -97.174480)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Jersey Village"] <- runif(1, -95.604056, -95.550498)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Lake Jackson"] <- runif(1, -95.513217, -95.410564)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Lakeway"] <- runif(1, -98.024422, -97.942712)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Madisonville"] <- runif(1, -90.181373, -90.153736)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Mandeville"] <- runif(1, -90.125740, -90.037163)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Midland"] <- runif(1, -102.225244, -102.018564)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="New Orleans"] <- runif(1, -90.137319, -89.627098)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Nolanville"] <- runif(1, -97.644801, -97.572360)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Oak Ridge North"] <- runif(1, -95.450484, -95.432546)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Odessa"] <- runif(1, -102.441403, -102.246052)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Pearland"] <- runif(1, -95.444382, -95.209549)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Port Arthur"] <- runif(1, -94.063257, -93.857950)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Richardson"] <- runif(1, -96.768302, -96.613806)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Richmond"] <- runif(1, -95.780910, -95.737823)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Richwood"] <- runif(1, -92.090179, -92.057478)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Roanoke"] <- runif(1, -97.257907, -97.206494)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Round Rock"] <- runif(1, -97.754839, -97.592340)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="San Antonio"] <- runif(1, -98.805584, -98.271373)
set.seed(2)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 2 & all_locations_txla$city=="San Antonio"] <- runif(1, -98.805584, -98.271373)
set.seed(3)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 3 & all_locations_txla$city=="San Antonio"] <- runif(1, -98.805584, -98.271373)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Sienna Plantation"] <- runif(1, -95.556849, -95.463809)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Sugar Land"] <- runif(1, -95.669530, -95.580609)
set.seed(1)
all_locations_txla$place_longitude[all_locations_txla$place_longitude == 1 & all_locations_txla$city=="Temple"] <- runif(1, -97.476884, -97.297669)

# Assigning imputed tweet coordinates as the official coordinates if coordinates do not already exist from when the tweet was originally made
all_locations_txla$latitude <- as.numeric(all_locations_txla$latitude)
all_locations_txla$longitude <- as.numeric(all_locations_txla$longitude)
all_locations_txla$place_latitude <- as.numeric(all_locations_txla$place_latitude)
all_locations_txla$place_longitude <- as.numeric(all_locations_txla$place_longitude)
all_locations_txla$latitude[is.na(all_locations_txla$latitude)] <- all_locations_txla$place_latitude[is.na(all_locations_txla$latitude)]
all_locations_txla$longitude[is.na(all_locations_txla$longitude)] <- all_locations_txla$place_longitude[is.na(all_locations_txla$longitude)]
all_locations_txla$latitude[all_locations_txla$latitude == 1] <- NA
all_locations_txla$latitude[all_locations_txla$latitude == 2] <- NA
all_locations_txla$latitude[all_locations_txla$latitude == 3] <- NA
all_locations_txla$latitude[all_locations_txla$latitude == 4] <- NA
all_locations_txla$latitude[all_locations_txla$latitude == 5] <- NA
all_locations_txla$longitude[all_locations_txla$longitude == 1] <- NA
all_locations_txla$longitude[all_locations_txla$longitude == 2] <- NA
all_locations_txla$longitude[all_locations_txla$longitude == 3] <- NA
all_locations_txla$longitude[all_locations_txla$longitude == 4] <- NA
all_locations_txla$longitude[all_locations_txla$longitude == 5] <- NA

# Checking user geographic coordinate locations, and setting those outside of Texas and Louisiana equal to NA
table(all_locations_txla$user_latitude, all_locations_txla$user_longitude)
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 8.101911] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -63.545078] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 32.572352] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -117.070763] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 34.046385] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -118.347937] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 37.717165] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -121.863282] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 38.39484] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -121.3492] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 40.761158] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -111.891908] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 40.761661] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -73.97022] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 42.770084] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -73.890678] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 45.526846] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -122.68205] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 53.569675] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -113.485938] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 24.697503] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -81.368524] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 34.631569] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -86.557273] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 34.631569] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -86.557273] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 35.549404] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -82.87282] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 36.119651] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -86.775456] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 38.835448] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -90.494483] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 40.75] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -73.997] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 41.354826] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -81.4412] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 42.538966] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -83.358822] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 44.766272] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -85.60598] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 44.9002] <- NA
all_locations_txla$user_longitude[all_locations_txla$user_longitude == -93.29377] <- NA

# Deleting user geographic coordinate locations that were outside of Texas and Louisiana, and do not have a corresponding tweet coordinate associated
all_locations_txla$latitude <- rowSums(all_locations_txla[,c("latitude", "null")], na.rm=TRUE)
all_locations_txla$user_latitude <- rowSums(all_locations_txla[,c("user_latitude", "null")], na.rm=TRUE)
all_locations_txla <- subset(all_locations_txla, city != "" | user_city != "" | latitude != 0 | user_latitude != 0)
all_locations_txla$latitude[all_locations_txla$latitude == 0] <- NA
all_locations_txla$user_latitude[all_locations_txla$user_latitude == 0] <- NA

# Assigning user geographic coordinate locations as the official coordinates if coordinates do not already exist
all_locations_txla$latitude <- as.numeric(all_locations_txla$latitude)
all_locations_txla$longitude <- as.numeric(all_locations_txla$longitude)
all_locations_txla$user_latitude <- as.numeric(all_locations_txla$user_latitude)
all_locations_txla$user_longitude <- as.numeric(all_locations_txla$user_longitude)
all_locations_txla$latitude[is.na(all_locations_txla$latitude)] <- all_locations_txla$user_latitude[is.na(all_locations_txla$latitude)]
all_locations_txla$longitude[is.na(all_locations_txla$longitude)] <- all_locations_txla$user_longitude[is.na(all_locations_txla$longitude)]

# Imputing user location geographic coordinates
table(all_locations_txla$city, all_locations_txla$state)
table(all_locations_txla$user_city, all_locations_txla$user_state)
all_locations_txla$user_state[all_locations_txla$user_city == "Austin"] <- "TX"
all_locations_txla$user_latitude_fill <- ave(all_locations_txla$user_state, all_locations_txla$user_city, FUN=seq_along)
all_locations_txla$user_longitude_fill <- ave(all_locations_txla$user_state, all_locations_txla$user_city, FUN=seq_along)
all_locations_txla$user_latitude_fill[all_locations_txla$user_city == ""] <- NA
all_locations_txla$user_longitude_fill[all_locations_txla$user_city == ""] <- NA
Abilene_count <- 1:4
for (i in Abilene_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Abilene"] <- runif(1, 32.344690, 32.625026)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Abilene"] <- runif(1, -99.849684, -99.631331)
}
Alief_count <- 1:1
for (i in Alief_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Alief, Houston"] <- runif(1, 29.711, 29.712)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Alief, Houston"] <- runif(1, -95.597, -95.596)
}
Alvin_count <- 1:1
for (i in Alvin_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Alvin"] <- runif(1, 29.073432, 29.503419)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Alvin"] <- runif(1, -95.581440, -95.058538)
}
Amarillo_count <- 1:3
for (i in Amarillo_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Amarillo"] <- runif(1, 35.109818, 35.295532)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Amarillo"] <- runif(1, -101.956012, -101.653888)
}
Argyle_count <- 1:1
for (i in Argyle_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Argyle"] <- runif(1, 33.085622, 33.134653)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Argyle"] <- runif(1, -97.229406, -97.139799)
}
Arlington_count <- 1:11
for (i in Arlington_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Arlington"] <- runif(1, 32.587864, 32.817252)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Arlington"] <- runif(1, -97.231553, -97.047532)
}
Austin_count <- 1:130
for (i in Austin_count){
  set.seed(i+6)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Austin"] <- runif(1, 30.129461, 30.517089)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Austin"] <- runif(1, -97.936090, -97.580408)
}
Baton_Rouge_count <- 1:6
for (i in Baton_Rouge_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Baton Rouge"] <- runif(1, 30.324707, 30.559725)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Baton Rouge"] <- runif(1, -91.215799, -91.002252)
}
Baytown_count <- 1:1
for (i in Baytown_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Baytown"] <- runif(1, 29.680798, 29.829528)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Baytown"] <- runif(1, -95.053694, -94.898512)
}
Beaumont_count <- 1:8
for (i in Beaumont_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Beaumont"] <- runif(1, 29.974059, 30.187958)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Beaumont"] <- runif(1, -94.224735, -94.035221)
}
Bedford_count <- 1:1
for (i in Bedford_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Bedford"] <- runif(1, 32.822216, 32.867790)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Bedford"] <- runif(1, -97.168662, -97.099912)
}
Bee_Cave_count <- 1:1
for (i in Bee_Cave_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Bee Cave"] <- runif(1, 30.288909, 30.326997)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Bee Cave"] <- runif(1, -98.002027, -97.917570)
}
Belton_count <- 1:1
for (i in Belton_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Belton"] <- runif(1, 30.967871, 31.106425)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Belton"] <- runif(1, -97.542151, -97.426451)
}
Big_Spring_count <- 1:3
for (i in Big_Spring_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Big Spring"] <- runif(1, 32.193880, 32.280564)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Big Spring"] <- runif(1, -101.535801, -101.401905)
}
Boerne_count <- 1:3
for (i in Boerne_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Boerne"] <- runif(1, 29.745561, 29.830480)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Boerne"] <- runif(1, -98.792589, -98.690279)
}
Bridge_City_count <- 1:1
for (i in Bridge_City_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Bridge City"] <- runif(1, 29.995258, 30.078924)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Bridge City"] <- runif(1, -93.885619, -93.765284)
}
Brownsville_count <- 1:1
for (i in Brownsville_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Brownsville"] <- runif(1, 25.840482, 26.215621)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Brownsville"] <- runif(1, -97.636948, -97.274399)
}
Bryan_count <- 1:1
for (i in Bryan_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Bryan"] <- runif(1, 30.590342, 30.730327)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Bryan"] <- runif(1, -96.460306, -96.278055)
}
BCS_count <- 1:1
for (i in BCS_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Bryan-College Station"] <- runif(1, 30.590342, 30.730327)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Bryan-College Station"] <- runif(1, -96.460306, -96.278055)
}
Buda_count <- 1:1
for (i in Buda_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Buda"] <- runif(1, 30.064542, 30.113557)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Buda"] <- runif(1, -97.872263, -97.810980)
}
Bulverde_count <- 1:1
for (i in Bulverde_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Bulverde"] <- runif(1, 29.736761, 29.811857)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Bulverde"] <- runif(1, -98.501708, -98.379141)
}
Burleson_count <- 1:1
for (i in Burleson_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Burleson"] <- runif(1, 32.461059, 32.572228)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Burleson"] <- runif(1, -97.427838, -97.264760)
}
Canyon_count <- 1:2
for (i in Canyon_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Canyon"] <- runif(1, 34.964651, 35.028634)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Canyon"] <- runif(1, -101.954444, -101.875823)
}
Carrollton_count <- 1:2
for (i in Carrollton_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Carrollton"] <- runif(1, 32.918645, 33.054571)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Carrollton"] <- runif(1, -96.958352, -96.838876)
}
Cedar_Park_count <- 1:2
for (i in Cedar_Park_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Cedar Park"] <- runif(1, 30.455553, 30.553316)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Cedar Park"] <- runif(1, -97.888616, -97.745451)
}
Celeste_count <- 1:1
for (i in Celeste_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Celeste"] <- runif(1, 33.278231, 33.303987)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Celeste"] <- runif(1, -96.207036, -96.186351)
}
Central_City_count <- 1:1
for (i in Central_City_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Central City"] <- runif(1, 27.708757, 27.817518)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Central City"] <- runif(1, -97.504307, -97.369381)
}
Chateau_Woods_count <- 1:1
for (i in Chateau_Woods_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Chateau Woods"] <- runif(1, 30.167, 30.168)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Chateau Woods"] <- runif(1, -95.421, -95.420)
}
Cinco_Ranch_count <- 1:1
for (i in Cinco_Ranch_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Cinco Ranch"] <- runif(1, 29.722513, 29.759030)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Cinco Ranch"] <- runif(1, -95.783625, -95.732556)
}
Cleburne_count <- 1:1
for (i in Cleburne_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Cleburne"] <- runif(1, 32.278401, 32.435879)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Cleburne"] <- runif(1, -97.455650, -97.346474)
}
Cloverleaf_count <- 1:1
for (i in Cloverleaf_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Cloverleaf"] <- runif(1, 29.771388, 29.808707)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Cloverleaf"] <- runif(1, -95.193150, -95.155986)
}
College_Station_count <- 1:8
for (i in College_Station_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="College Station"] <- runif(1, 30.523721, 30.657601)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="College Station"] <- runif(1, -96.386077, -96.196907)
}
Collin_County_count <- 1:1
for (i in Collin_County_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Collin County"] <- runif(1, 32.986090, 33.402098)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Collin County"] <- runif(1, -96.842845, -96.297649)
}
Columbia_count <- 1:1
for (i in Columbia_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Columbia"] <- runif(1, 29.119703, 29.159286)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Columbia"] <- runif(1, -95.668001, -95.634699)
}
Commerce_count <- 1:2
for (i in Commerce_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Commerce"] <- runif(1, 33.212334, 33.300329)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Commerce"] <- runif(1, -95.937989, -95.874131)
}
Conroe_count <- 1:3
for (i in Conroe_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Conroe"] <- runif(1, 30.212725, 30.391465)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Conroe"] <- runif(1, -95.564441, -95.390720)
}
Coppell_count <- 1:1
for (i in Coppell_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Coppell"] <- runif(1, 32.922965, 32.994694)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Coppell"] <- runif(1, -97.032801, -96.932894)
}
Copperas_Cove_count <- 1:1
for (i in Copperas_Cove_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Copperas Cove"] <- runif(1, 31.058047, 31.164160)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Copperas Cove"] <- runif(1, -97.967420, -97.867856)
}
Corpus_Christi_count <- 1:12
for (i in Corpus_Christi_count){
  set.seed(i+2)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Corpus Christi"] <- runif(1, 27.558603, 27.881972)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Corpus Christi"] <- runif(1, -97.682740, -97.094971)
}
Covington_count <- 1:1
for (i in Covington_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Covington"] <- runif(1, 30.440002, 30.506874)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Covington"] <- runif(1, -90.153855, -90.081414)
}
Crosstimbers_count <- 1:1
for (i in Crosstimbers_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Crosstimbers"] <- runif(1, 29.828, 29.829)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Crosstimbers"] <- runif(1, -95.393, -95.392)
}
Cut_and_Shoot_count <- 1:4
for (i in Cut_and_Shoot_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Cut and Shoot"] <- runif(1, 30.326564, 30.371080)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Cut and Shoot"] <- runif(1, -95.399059, -95.327305)
}
Cypress_count <- 1:9
for (i in Cypress_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Cypress"] <- runif(1, 29.970, 29.971)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Cypress"] <- runif(1, -95.698, -95.697)
}
Dalhart_count <- 1:1
for (i in Dalhart_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Dalhart"] <- runif(1, 36.027859, 36.081289)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Dalhart"] <- runif(1, -102.543154, -102.479811)
}
Dallas_count <- 1:106
for (i in Dallas_count){
  set.seed(i+2)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Dallas"] <- runif(1, 32.620473, 33.01287)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Dallas"] <- runif(1, -96.992508, -96.557174)
}
Dayton_count <- 1:2
for (i in Dayton_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Dayton"] <- runif(1, 29.899102, 30.132169)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Dayton"] <- runif(1, -95.008736, -94.855614)
}
Deer_Park_count <- 1:2
for (i in Deer_Park_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Deer Park"] <- runif(1, 29.664129, 29.740323)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Deer Park"] <- runif(1, -95.143796, -95.088428)
}
Del_Rio_count <- 1:2
for (i in Del_Rio_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Del Rio"] <- runif(1, 29.327295, 29.428415)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Del Rio"] <- runif(1, -100.936227, -100.808511)
}
Denham_Springs_count <- 1:1
for (i in Denham_Springs_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Denham Springs"] <- runif(1, 30.445425, 30.504603)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Denham Springs"] <- runif(1, -90.991458, -90.931033)
}
Denton_count <- 1:8
for (i in Denton_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Denton"] <- runif(1, 33.133499, 33.358608)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Denton"] <- runif(1, -97.266698, -97.025686)
}
Denton_County_count <- 1:1
for (i in Denton_County_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Denton County"] <- runif(1, 32.985073, 33.432035)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Denton County"] <- runif(1, -97.397817, -96.834767)
}
DeRidder_count <- 1:1
for (i in DeRidder_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="DeRidder"] <- runif(1, 30.810379, 30.890697)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="DeRidder"] <- runif(1, -93.336600, -93.255061)
}
Desoto_count <- 1:2
for (i in Desoto_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Desoto"] <- runif(1, 32.565084, 32.647654)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Desoto"] <- runif(1, -96.908390, -96.822559)
}
Dickinson_count <- 1:2
for (i in Dickinson_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Dickinson"] <- runif(1, 29.425408, 29.477426)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Dickinson"] <- runif(1, -95.109664, -95.009929)
}
Edinburg_count <- 1:4
for (i in Edinburg_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Edinburg"] <- runif(1, 26.247458, 26.450510)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Edinburg"] <- runif(1, -98.225703, -98.111376)
}
El_Paso_count <- 1:8
for (i in El_Paso_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="El Paso"] <- runif(1, 31.787129, 31.998753)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="El Paso"] <- runif(1, -106.611714, -106.324964)
}
Elgin_count <- 1:1
for (i in Elgin_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Elgin"] <- runif(1, 30.332132, 30.378274)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Elgin"] <- runif(1, -97.427063, -97.357368)
}
Flower_Mound_count <- 1:1
for (i in Flower_Mound_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Flower Mound"] <- runif(1, 32.981416, 33.091362)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Flower Mound"] <- runif(1, -97.234326, -97.028333)
}
Fort_Worth_count <- 1:23
for (i in Fort_Worth_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Fort Worth"] <- runif(1, 32.554286, 33.047184)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Fort Worth"] <- runif(1, -97.543420, -97.035302)
}
Fredericksburg_count <- 1:1
for (i in Fredericksburg_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Fredericksburg"] <- runif(1, 30.235232, 30.300467)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Fredericksburg"] <- runif(1, -98.919431, -98.836347)
}
Friendswood_count <- 1:5
for (i in Friendswood_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Friendswood"] <- runif(1, 29.455653, 29.573070)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Friendswood"] <- runif(1, -95.233606, -95.147088)
}
Frisco_count <- 1:11
for (i in Frisco_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Frisco"] <- runif(1, 33.081519, 33.219348)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Frisco"] <- runif(1, -96.922558, -96.733387)
}
Fulshear_count <- 1:1
for (i in Fulshear_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Fulshear"] <- runif(1, 29.643065, 29.734480)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Fulshear"] <- runif(1, -95.912845, -95.846412)
}
Galveston_count <- 1:2
for (i in Galveston_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Galveston"] <- runif(1, 29.083297, 29.351776)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Galveston"] <- runif(1, -95.122330, -94.731875)
}
Galveston_Island_count <- 1:2
for (i in Galveston_Island_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Galveston Island"] <- runif(1, 29.220172, 29.266904)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Galveston Island"] <- runif(1, -94.936942, -94.840366)
}
Garland_count <- 1:3
for (i in Garland_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Garland"] <- runif(1, 32.830833, 32.985039)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Garland"] <- runif(1, -96.70562, -96.529153)
}
Georgetown_count <- 1:3
for (i in Georgetown_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Georgetown"] <- runif(1, 30.572143, 30.742258)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Georgetown"] <- runif(1, -97.832548, -97.601149)
}
Gladewater_count <- 1:1
for (i in Gladewater_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Gladewater"] <- runif(1, 32.510040, 32.584705)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Gladewater"] <- runif(1, -94.982796, -94.903488)
}
Golden_count <- 1:1
for (i in Golden_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Golden"] <- runif(1, 32.729, 32.730)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Golden"] <- runif(1, -95.564, -95.563)
}
Granbury_count <- 1:2
for (i in Granbury_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Granbury"] <- runif(1, 32.418601, 32.514190)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Granbury"] <- runif(1, -97.835009, -97.629015)
}
Grand_Cane_count <- 1:1
for (i in Grand_Cane_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Grand Cane"] <- runif(1, 32.075312, 32.094220)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Grand Cane"] <- runif(1, -93.820226, -93.797352)
}
Grand_Prairie_count <- 1:4
for (i in Grand_Prairie_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Grand Prairie"] <- runif(1, 32.500194, 32.817562)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Grand Prairie"] <- runif(1, -97.079437, -96.924942)
}
Grapevine_count <- 1:1
for (i in Grapevine_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Grapevine"] <- runif(1, 32.878689, 32.993370)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Grapevine"] <- runif(1, -97.129396, -97.016786)
}
Hammond_count <- 1:1
for (i in Hammond_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Hammond"] <- runif(1, 30.462889, 30.545715)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Hammond"] <- runif(1, -90.516753, -90.398307)
}
Harlingen_count <- 1:3
for (i in Harlingen_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Harlingen"] <- runif(1, 26.057460, 26.280547)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Harlingen"] <- runif(1, -97.797401, -97.616813)
}
Hawkins_count <- 1:1
for (i in Hawkins_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Hawkins"] <- runif(1, 32.579833, 32.607890)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Hawkins"] <- runif(1, -95.216165, -95.190588)
}
Heath_count <- 1:1
for (i in Heath_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Heath"] <- runif(1, 32.809776, 32.876407)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Heath"] <- runif(1, -96.507976, -96.433819)
}
Helotes_count <- 1:1
for (i in Helotes_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Helotes"] <- runif(1, 29.540558, 29.592069)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Helotes"] <- runif(1, -98.723364, -98.663798)
}
Hideaway_count <- 1:1
for (i in Hideaway_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Hideaway"] <- runif(1, 32.470501, 32.511116)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Hideaway"] <- runif(1, -95.467869, -95.446325)
}
Highlands_count <- 1:1
for (i in Highlands_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Highlands"] <- runif(1, 29.792839, 29.832979)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Highlands"] <- runif(1, -95.081961, -95.027544)
}
Houma_count <- 1:4
for (i in Houma_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Houma"] <- runif(1, 29.545136, 29.611571)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Houma"] <- runif(1, -90.767556, -90.636578)
}
Houston_count <- 1:416
for (i in Houston_count){
  set.seed(i+36)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Houston"] <- runif(1, 29.542464, 30.105995)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Houston"] <- runif(1, -95.786337, -95.079983)
}
Huffman_count <- 1:1
for (i in Huffman_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Huffman"] <- runif(1, 30.027, 30.028)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Huffman"] <- runif(1, -95.086, -95.085)
}
Humble_count <- 1:3
for (i in Humble_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Humble"] <- runif(1, 29.954359, 30.032412)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Humble"] <- runif(1, -95.284061, -95.243893)
}
Huntsville_count <- 1:2
for (i in Huntsville_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Huntsville"] <- runif(1, 30.626606, 30.767128)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Huntsville"] <- runif(1, -95.643001, -95.493998)
}
Hurst_count <- 1:1
for (i in Hurst_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Hurst"] <- runif(1, 32.804603, 32.889258)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Hurst"] <- runif(1, -97.212417, -97.137573)
}
Ingleside_count <- 1:1
for (i in Ingleside_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Ingleside"] <- runif(1, 27.821463, 27.912061)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Ingleside"] <- runif(1, -97.242802, -97.174480)
}
Irving_count <- 1:3
for (i in Irving_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Irving"] <- runif(1, 32.772547, 32.953650)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Irving"] <- runif(1, -97.034564, -96.889682)
}
Jasper_count <- 1:1
for (i in Jasper_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Jasper"] <- runif(1, 30.882279, 30.966805)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Jasper"] <- runif(1, -94.036378, -93.946943)
}
Katy_count <- 1:23
for (i in Katy_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Katy"] <- runif(1, 29.752305, 29.831113)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Katy"] <- runif(1, -95.862678, -95.797447)
}
Kemah_count <- 1:1
for (i in Kemah_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Kemah"] <- runif(1, 29.521066, 29.548921)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Kemah"] <- runif(1, -95.033730, -95.001886)
}
Killeen_count <- 1:6
for (i in Killeen_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Killeen"] <- runif(1, 31.022181, 31.140383)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Killeen"] <- runif(1, -97.822006, -97.651718)
}
Kingsville_count <- 1:2
for (i in Kingsville_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Kingsville"] <- runif(1, 27.462993, 27.542474)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Kingsville"] <- runif(1, -97.895283, -97.830223)
}
Kingwood_count <- 1:2
for (i in Kingwood_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Kingwood"] <- runif(1, 30.021666, 30.095953)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Kingwood"] <- runif(1, -95.293491, -95.120113)
}
Kirbyville_count <- 1:1
for (i in Kirbyville_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Kirbyville"] <- runif(1, 30.634804, 30.680581)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Kirbyville"] <- runif(1, -93.923767, -93.883598)
}
Klein_count <- 1:1
for (i in Klein_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Klein"] <- runif(1, 30.046, 30.047)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Klein"] <- runif(1, -95.536, -95.535)
}
Krum_count <- 1:1
for (i in Krum_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Krum"] <- runif(1, 33.252980, 33.281758)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Krum"] <- runif(1, -97.246353, -97.207300)
}
La_Villa_count <- 1:1
for (i in La_Villa_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="La Villa"] <- runif(1, 26.289428, 26.301797)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="La Villa"] <- runif(1, -97.934524, -97.916349)
}
Labelle_count <- 1:1
for (i in Labelle_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Labelle"] <- runif(1, 29.880, 29.881)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Labelle"] <- runif(1, -94.162, -94.161)
}
Lafayette_count <- 1:6
for (i in Lafayette_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Lafayette"] <- runif(1, 30.127977, 30.296496)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Lafayette"] <- runif(1, -92.108266, -91.973684)
}
Lake_Charles_count <- 1:2
for (i in Lake_Charles_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Lake Charles"] <- runif(1, 30.125014, 30.271895)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Lake Charles"] <- runif(1, -93.316939, -93.129142)
}
Laredo_count <- 1:3
for (i in Laredo_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Laredo"] <- runif(1, 27.367283, 27.702161)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Laredo"] <- runif(1, -99.593584, -99.330599)
}
League_City_count <- 1:3
for (i in League_City_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="League City"] <- runif(1, 29.428237, 29.555541)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="League City"] <- runif(1, -95.225881, -94.998258)
}
Live_Oak_count <- 1:1
for (i in Live_Oak_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Live Oak"] <- runif(1, 29.530620, 29.580569)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Live Oak"] <- runif(1, -98.361158, -98.318500)
}
Llano_count <- 1:1
for (i in Llano_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Llano"] <- runif(1, 30.727126, 30.790851)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Llano"] <- runif(1, -98.716234, -98.640188)
}
Longview_count <- 1:3
for (i in Longview_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Longview"] <- runif(1, 32.431247, 32.582094)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Longview"] <- runif(1, -94.844236, -94.667081)
}
Lorena_count <- 1:1
for (i in Lorena_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Lorena"] <- runif(1, 31.347784, 31.409924)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Lorena"] <- runif(1, -97.231014, -97.192562)
}
Lubbock_count <- 1:4
for (i in Lubbock_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Lubbock"] <- runif(1, 33.474874, 33.708812)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Lubbock"] <- runif(1, -102.028530, -101.749752)
}
Lufkin_count <- 1:4
for (i in Lufkin_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Lufkin"] <- runif(1, 31.266176, 31.380263)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Lufkin"] <- runif(1, -94.775401, -94.678584)
}
Lumberton_count <- 1:2
for (i in Lumberton_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Lumberton"] <- runif(1, 30.229004, 30.298985)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Lumberton"] <- runif(1, -94.237261, -94.169283)
}
Mabank_count <- 1:1
for (i in Mabank_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Mabank"] <- runif(1, 32.338034, 32.394581)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Mabank"] <- runif(1, -96.155158, -96.076022)
}
Madisonville_count <- 1:3
for (i in Madisonville_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Madisonville"] <- runif(1, 30.381680, 30.420027)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Madisonville"] <- runif(1, -90.181373, -90.153736)
}
Marble_Falls_count <- 1:1
for (i in Marble_Falls_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Marble Falls"] <- runif(1, 30.551183, 30.628763)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Marble Falls"] <- runif(1, -98.295663, -98.237298)
}
McAllen_count <- 1:4
for (i in McAllen_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="McAllen"] <- runif(1, 26.102656, 26.350271)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="McAllen"] <- runif(1, -98.317763, -98.196913)
}
McKinney_count <- 1:3
for (i in McKinney_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="McKinney"] <- runif(1, 33.125714, 33.305232)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="McKinney"] <- runif(1, -96.768437, -96.538754)
}
Merit_count <- 1:1
for (i in Merit_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Merit"] <- runif(1, 33.216, 33.217)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Merit"] <- runif(1, -96.288, -9.287)
}
Mesquite_count <- 1:1
for (i in Mesquite_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Mesquite"] <- runif(1, 32.681910, 32.849354)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Mesquite"] <- runif(1, -96.683762, -96.471588)
}
Metairie_count <- 1:2
for (i in Metairie_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Metairie"] <- runif(1, 29.968284, 30.033695)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Metairie"] <- runif(1, -90.236948, -90.121420)
}
all_locations_txla$user_city[all_locations_txla$user_city == "Miami Beach"] <- "Miami"
Miami_count <- 1:1
for (i in Miami_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Miami"] <- runif(1, 35.680109, 35.701928)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Miami"] <- runif(1, -100.652671, -100.629411)
}
Midland_count <- 1:4
for (i in Midland_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Midland"] <- runif(1, 31.927002, 32.131327)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Midland"] <- runif(1, -102.225244, -102.018564)
}
Midlothian_count <- 1:1
for (i in Midlothian_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Midlothian"] <- runif(1, 32.393518, 32.544717)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Midlothian"] <- runif(1, -97.075223, -96.902188)
}
Missouri_City_count <- 1:4
for (i in Missouri_City_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Missouri City"] <- runif(1, 29.456696, 29.641870)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Missouri City"] <- runif(1, -95.594985, -95.483405)
}
Monroe_count <- 1:4
for (i in Monroe_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Monroe"] <- runif(1, 32.429879, 32.598374)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Monroe"] <- runif(1, -92.135848, -92.001952)
}
Nacogdoches_count <- 1:1
for (i in Nacogdoches_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Nacogdoches"] <- runif(1, 31.559616, 31.673346)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Nacogdoches"] <- runif(1, -94.692818, -94.593255)
}
Natchitoches_count <- 1:1
for (i in Natchitoches_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Natchitoches"] <- runif(1, 31.649354, 31.791869)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Natchitoches"] <- runif(1, -93.162606, -93.052056)
}
Navasota_count <- 1:1
for (i in Navasota_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Navasota"] <- runif(1, 30.358077, 30.420565)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Navasota"] <- runif(1, -96.122566, -96.063171)
}
Nederland_count <- 1:3
for (i in Nederland_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Nederland"] <- runif(1, 29.946803, 30.018917)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Nederland"] <- runif(1, -94.041766, -93.962801)
}
New_Braunfels_count <- 1:5
for (i in New_Braunfels_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="New Braunfels"] <- runif(1, 29.631130, 29.768014)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="New Braunfels"] <- runif(1, -98.245317, -98.028337)
}
New_Caney_count <- 1:1
for (i in New_Caney_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="New Caney"] <- runif(1, 30.155, 30.156)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="New Caney"] <- runif(1, -95.212, -95.211)
}
New_Orleans_count <- 1:22
for (i in New_Orleans_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="New Orleans"] <- runif(1, 29.869312, 30.174301)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="New Orleans"] <- runif(1, -90.137319, -89.627098)
}
North_Cleveland_count <- 1:1
for (i in North_Cleveland_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="North Cleveland"] <- runif(1, 30.339270, 30.374672)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="North Cleveland"] <- runif(1, -95.110951, -95.089923)
}
Odessa_count <- 1:1
for (i in Odessa_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Odessa"] <- runif(1, 31.799299, 31.954692)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Odessa"] <- runif(1, -102.441403, -102.246052)
}
Orange_count <- 1:1
for (i in Orange_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Orange"] <- runif(1, 30.053797, 30.154781)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Orange"] <- runif(1, -93.833739, -93.701077)
}
Palmer_count <- 1:1
for (i in Palmer_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Palmer"] <- runif(1, 32.409745, 32.446403)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Palmer"] <- runif(1, -96.702947, -96.654367)
}
Paradise_count <- 1:1
for (i in Paradise_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Paradise"] <- runif(1, 33.138446, 33.162232)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Paradise"] <- runif(1, -97.699477, -97.678191)
}
Pasadena_count <- 1:2
for (i in Pasadena_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Pasadena"] <- runif(1, 29.558714, 29.740720)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Pasadena"] <- runif(1, -95.233585, -94.983989)
}
Pearland_count <- 1:5
for (i in Pearland_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Pearland"] <- runif(1, 29.501570, 29.597741)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Pearland"] <- runif(1, -95.444382, -95.209549)
}
Pecos_count <- 1:1
for (i in Pecos_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Pecos"] <- runif(1, 31.371949, 31.438905)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Pecos"] <- runif(1, -103.537327, -103.480850)
}
Pflugerville_count <- 1:1
for (i in Pflugerville_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Pflugerville"] <- runif(1, 30.402752, 30.500420)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Pflugerville"] <- runif(1, -97.668724, -97.528648)
}
Piney_Woods_count <- 1:1
for (i in Piney_Woods_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Piney Woods"] <- runif(1, 29.600, 29.601)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Piney Woods"] <- runif(1, -98.512, -98.511)
}
Plano_count <- 1:3
for (i in Plano_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Plano"] <- runif(1, 32.999358, 33.125096)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Plano"] <- runif(1, -96.858164, -96.612689)
}
Port_Aransas_count <- 1:1
for (i in Port_Aransas_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Port Aransas"] <- runif(1, 27.749147, 27.863331)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Port Aransas"] <- runif(1, -97.128607, -97.045866)
}
Port_Arthur_count <- 1:6
for (i in Port_Arthur_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Port Arthur"] <- runif(1, 29.679602, 30.032146)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Port Arthur"] <- runif(1, -94.063257, -93.857950)
}
Port_Neches_count <- 1:1
for (i in Port_Neches_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Port Neches"] <- runif(1, 29.942972, 30.005130)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Port Neches"] <- runif(1, -93.983182, -93.899239)
}
Prairie_View_count <- 1:1
for (i in Prairie_View_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Prairie View"] <- runif(1, 30.060993, 30.106148)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Prairie View"] <- runif(1, -96.013941, -95.960211)
}
Preston_count <- 1:1
for (i in Preston_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Preston"] <- runif(1, 29.677129, 29.677735)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Preston"] <- runif(1, -95.219755, -95.219368)
}
Quitman_count <- 1:1
for (i in Quitman_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Quitman"] <- runif(1, 32.342745, 32.362721)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Quitman"] <- runif(1, -92.739557, -92.710803)
}
Richardson_count <- 1:3
for (i in Richardson_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Richardson"] <- runif(1, 32.923345, 33.004288)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Richardson"] <- runif(1, -96.768302, -96.613806)
}
Richland_count <- 1:1
for (i in Richland_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Richland"] <- runif(1, 31.914674, 31.936237)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Richland"] <- runif(1, -96.448237, -96.407124)
}
Richmond_count <- 1:7
for (i in Richmond_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Richmond"] <- runif(1, 29.554957, 29.610640)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Richmond"] <- runif(1, -95.780910, -95.737823)
}
Rockport_count <- 1:4
for (i in Rockport_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Rockport"] <- runif(1, 27.995958, 28.086863)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Rockport"] <- runif(1, -97.092158, -97.025726)
}
Rockwall_count <- 1:4
for (i in Rockwall_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Rockwall"] <- runif(1, 32.863824, 32.977084)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Rockwall"] <- runif(1, -96.494069, -96.375966)
}
Round_Rock_count <- 1:8
for (i in Round_Rock_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Round Rock"] <- runif(1, 30.469057, 30.577301)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Round Rock"] <- runif(1, -97.754839, -97.592340)
}
Rowlett_count <- 1:1
for (i in Rowlett_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Rowlett"] <- runif(1, 32.873261, 32.975277)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Rowlett"] <- runif(1, -96.593812, -96.502832)
}
Rusk_count <- 1:1
for (i in Rusk_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Rusk"] <- runif(1, 31.777829, 31.818389)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Rusk"] <- runif(1, -95.199590, -95.112386)
}
Sabine_Pass_count <- 1:1
for (i in Sabine_Pass_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Sabine Pass"] <- runif(1, 29.733, 29.734)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Sabine Pass"] <- runif(1, -95.895, -95.894)
}
Saginaw_count <- 1:1
for (i in Saginaw_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Saginaw"] <- runif(1, 32.817221, 32.886153)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Saginaw"] <- runif(1, -97.392786, -97.325667)
}
San_Antonio_count <- 1:67
for (i in San_Antonio_count){
  set.seed(i+3)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="San Antonio"] <- runif(1, 29.228579, 29.737837)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="San Antonio"] <- runif(1, -98.805584, -98.271373)
}
San_Marcos_count <- 1:4
for (i in San_Marcos_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="San Marcos"] <- runif(1, 29.777706, 29.960504)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="San Marcos"] <- runif(1, -98.012148, -97.842546)
}
Santa_Fe_count <- 1:1
for (i in Santa_Fe_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Santa Fe"] <- runif(1, 29.349776, 29.429496)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Santa Fe"] <- runif(1, -95.192216, -95.049566)
}
Schertz_count <- 1:1
for (i in Schertz_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Schertz"] <- runif(1, 29.468253, 29.650421)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Schertz"] <- runif(1, -98.306588, -98.197755)
}
Sherman_count <- 1:1
for (i in Sherman_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Sherman"] <- runif(1, 33.530216, 33.708044)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Sherman"] <- runif(1, -96.674651, -96.550369)
}
Shoreacres_count <- 1:1
for (i in Shoreacres_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Shoreacres"] <- runif(1, 29.616903, 29.624140)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Shoreacres"] <- runif(1, -95.036142, -94.999149)
}
Shreveport_count <- 1:2
for (i in Shreveport_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Shreveport"] <- runif(1, 32.333118, 32.588038)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Shreveport"] <- runif(1, -93.938022, -93.682590)
}
Sinton_count <- 1:2
for (i in Sinton_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Sinton"] <- runif(1, 28.021271, 28.046727)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Sinton"] <- runif(1, -97.542537, -97.489150)
}
Slidell_count <- 1:1
for (i in Slidell_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Slidell"] <- runif(1, 30.240074, 30.358348)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Slidell"] <- runif(1, -89.834392, -89.723499)
}
Spring_count <- 1:18
for (i in Spring_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Spring"] <- runif(1, 30.026663, 30.115649)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Spring"] <- runif(1, -95.437159, -95.309958)
}
Spring_Branch_count <- 1:1
for (i in Spring_Branch_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Spring Branch"] <- runif(1, 29.890, 29.891)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Spring Branch"] <- runif(1, -98.426, -98.425)
}
Stagecoach_count <- 1:1
for (i in Stagecoach_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Stagecoach"] <- runif(1, 30.132936, 30.157652)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Stagecoach"] <- runif(1, -95.719408, -95.682759)
}
Stephenville_count <- 1:1
for (i in Stephenville_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Stephenville"] <- runif(1, 32.188880, 32.241310)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Stephenville"] <- runif(1, -98.263259, -98.173308)
}
Stone_Oak_count <- 1:1
for (i in Stone_Oak_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Stone Oak"] <- runif(1, 29.608836, 29.658522)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Stone Oak"] <- runif(1, -98.519739, -98.449186)
}
Sugar_Land_count <- 1:8
for (i in Sugar_Land_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Sugar Land"] <- runif(1, 29.511887, 29.661464)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Sugar Land"] <- runif(1, -95.669530, -95.580609)
}
Sweeny_count <- 1:1
for (i in Sweeny_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Sweeny"] <- runif(1, 29.032986, 29.058873)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Sweeny"] <- runif(1, -95.722781, -95.679522)
}
Tallulah_count <- 1:1
for (i in Tallulah_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Tallulah"] <- runif(1, 32.381553, 32.423802)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Tallulah"] <- runif(1, -91.209964, -91.171340)
}
Temple_count <- 1:2
for (i in Temple_count){
  set.seed(i+1)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Temple"] <- runif(1, 31.029838, 31.177114)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Temple"] <- runif(1, -97.476884, -97.297669)
}
Terrell_count <- 1:2
for (i in Terrell_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Terrell"] <- runif(1, 32.681591, 32.778055)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Terrell"] <- runif(1, -96.356033, -96.230377)
}
Texas_AM_University_count <- 1:2
for (i in Texas_AM_University_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Texas A&M University"] <- runif(1, 30.604999, 30.627528)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Texas A&M University"] <- runif(1, -96.348413, -96.323608)
}
The_Woodlands_count <- 1:8
for (i in The_Woodlands_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="The Woodlands"] <- runif(1, 30.105666, 30.232111)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="The Woodlands"] <- runif(1, -95.601101, -95.446949)
}
Tomball_count <- 1:4
for (i in Tomball_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Tomball"] <- runif(1, 30.061500, 30.135906)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Tomball"] <- runif(1, -95.664212, -95.588853)
}
Troy_count <- 1:2
for (i in Troy_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Troy"] <- runif(1, 31.170459, 31.230954)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Troy"] <- runif(1, -97.319470, -97.282734)
}
Tyler_count <- 1:3
for (i in Tyler_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Tyler"] <- runif(1, 32.231279, 32.393187)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Tyler"] <- runif(1, -95.459927, -95.230587)
}
University_Park_count <- 1:1
for (i in University_Park_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="University Park"] <- runif(1, 32.836520, 32.865687)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="University Park"] <- runif(1, -96.815040, -96.770494)
}
Victoria_count <- 1:3
for (i in Victoria_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Victoria"] <- runif(1, 28.763650, 28.895688)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Victoria"] <- runif(1, -97.051379, -96.900660)
}
Vidor_count <- 1:1
for (i in Vidor_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Vidor"] <- runif(1, 30.090002, 30.154887)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Vidor"] <- runif(1, -94.039870, -93.963824)
}
Vinton_count <- 1:1
for (i in Vinton_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Vinton"] <- runif(1, 30.169391, 30.213013)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Vinton"] <- runif(1, -93.600349, -93.562155)
}
Waco_count <- 1:5
for (i in Waco_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Waco"] <- runif(1, 31.452556, 31.660854)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Waco"] <- runif(1, -97.329724, -97.048200)
}
Warren_count <- 1:1
for (i in Warren_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Warren"] <- runif(1, 30.614, 30.615)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Warren"] <- runif(1, -94.409, -94.408)
}
all_locations_txla$user_state[all_locations_txla$user_city == "Washington"] <- "LA"
Washington_count <- 1:1
for (i in Washington_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Washington"] <- runif(1, 30.606164, 30.624224)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Washington"] <- runif(1, -92.071186, -92.042518)
}
Watauga_count <- 1:1
for (i in Watauga_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Watauga"] <- runif(1, 32.853261, 32.894566)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Watauga"] <- runif(1, -97.272540, -97.238208)
}
Waxahachie_count <- 1:1
for (i in Waxahachie_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Waxahachie"] <- runif(1, 32.318471, 32.494414)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Waxahachie"] <- runif(1, -96.926116, -96.766128)
}
Weslaco_count <- 1:1
for (i in Weslaco_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Weslaco"] <- runif(1, 26.112681, 26.199314)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Weslaco"] <- runif(1, -98.021765, -97.950010)
}
West_Monroe_count <- 1:1
for (i in West_Monroe_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="West Monroe"] <- runif(1, 32.481625, 32.551250)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="West Monroe"] <- runif(1, -92.197783, -92.112811)
}
West_University_Place_count <- 1:1
for (i in West_University_Place_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="West University Place"] <- runif(1, 29.706055, 29.725548)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="West University Place"] <- runif(1, -95.447468, -95.418328)
}
Willis_count <- 1:1
for (i in Willis_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Willis"] <- runif(1, 30.403682, 30.443353)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Willis"] <- runif(1, -95.503883, -95.451955)
}
Winnsboro_count <- 1:1
for (i in Winnsboro_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Winnsboro"] <- runif(1, 32.932690, 32.977198)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Winnsboro"] <- runif(1, -95.313337, -95.264156)
}
Wylie_count <- 1:1
for (i in Wylie_count){
  set.seed(i)
  all_locations_txla$user_latitude_fill[all_locations_txla$user_latitude_fill == i & all_locations_txla$user_city=="Wylie"] <- runif(1, 32.968344, 33.040612)
  all_locations_txla$user_longitude_fill[all_locations_txla$user_longitude_fill == i & all_locations_txla$user_city=="Wylie"] <- runif(1, -96.595933, -96.489503)
}

# Setting the user location geographic coordinates as latitude and longitude, if that tweet does not already have geographic coordinates assigned
all_locations_txla$latitude <- as.numeric(all_locations_txla$latitude)
all_locations_txla$longitude <- as.numeric(all_locations_txla$longitude)
all_locations_txla$user_latitude_fill <- as.numeric(all_locations_txla$user_latitude_fill)
all_locations_txla$user_longitude_fill <- as.numeric(all_locations_txla$user_longitude_fill)
all_locations_txla$latitude[is.na(all_locations_txla$latitude)] <- all_locations_txla$user_latitude_fill[is.na(all_locations_txla$latitude)]
all_locations_txla$longitude[is.na(all_locations_txla$longitude)] <- all_locations_txla$user_longitude_fill[is.na(all_locations_txla$longitude)]

# Exporting all_locations_txla to a final dataset
final <- all_locations_txla

# Checking for any missings in coordinates
misscheck <- is.na(final$latitude)
table(misscheck)
misscheck <- is.na(final$longitude)
table(misscheck)
# And none are missing, which is good

# Filling in the city and state with user city and state, if a value is not already there
final$city[is.na(final$city)] <- final$user_city[is.na(final$city)]
final$state[is.na(final$state)] <- final$user_state[is.na(final$state)]

# Checking for any missings in city and state
misscheck <- is.na(final$city)
table(misscheck)
misscheck <- is.na(final$state)
table(misscheck)
# There are six missings from the user locations set as geographic coordinates, and 5 cities set to "". These will be filled in with the geographic coordinates shortly

# First removing unneeded variables
final$user_screen_name <- NULL
final$user_location <- NULL
final$place_name <- NULL
final$place_full_name <- NULL
final$place_country_code <- NULL
final$place_country <- NULL
final$coordinates_type <- NULL
final$user_city <- NULL
final$user_state <- NULL
final$user_latitude <- NULL
final$user_longitude <- NULL
final$null <- NULL
final$place_latitude <- NULL
final$place_longitude <- NULL
final$user_latitude_fill <- NULL
final$user_longitude_fill <- NULL

# Now filling in the cities and states that are missing or set to "", based on the coordinates
final$city[final$user_name=="Kurt von Schleicher"] <- "Addison"
final$state[final$user_name=="Kurt von Schleicher"] <- "TX"
final$city[final$user_id==19671247] <- "Northeast Dallas"
final$state[final$user_id==19671247] <- "TX"
final$city[final$user_id==22101409] <- "Allen"
final$state[final$user_id==22101409] <- "TX"
final$city[final$user_id==28441014] <- "Westbury"
final$state[final$user_id==28441014] <- "TX"
final$city[final$user_id==74006763] <- "Northside"
final$state[final$user_id==74006763] <- "TX"
final$city[final$user_id==156791542] <- "Abilene"
final$city[final$user_id==488142832] <- "Richwood"
final$city[final$user_id==3059696253] <- "Pearland"
final$state[final$user_id==3059696253] <- "TX"
final$city[final$user_name=="Justin Elbert"] <- "Klein"
final$city[final$user_name=="Amanda Farthing"] <- "Pearland"
final$city[final$user_name=="Cathy Steen"] <- "Celeste"

# Checking for any missings in city and state again
misscheck <- is.na(final$city)
table(misscheck)
misscheck <- is.na(final$state)
table(misscheck)
# And there are none left, which is good

# Checking to see that every tweet has a city and state assigned
table(final$city, final$state)
# And it does, which is also good

# Removing user_name from the dataset
final$user_name <- NULL

# Removing two outlier observations that were not imputed properly
max(final$longitude)
min(final$latitude)
final <- subset(final, city != "Merit")
final <- subset(final, latitude != 25.804)
max(final$longitude)
min(final$longitude)
max(final$latitude)
min(final$latitude)
# And all looks good

saveRDS(final, "final.rds")
```

*Methods*

Data cleaning was performed with the assistance of the R packages tibble (13), dplyr (14), tidyr (15), stringr (16), and data.table (17). Tweets were restricted to only those that had a user location recorded, which gave a sample of 15,535 tweets. Then, tweets were further restricted to those either with geographic coordinates already saved, those made in Texas or Louisiana (tweet location), those with a user location set within Texas or Louisiana, or those with a user location of geographic coordinates. This left 1,842 tweets, 21 of which had geographic coordinates already saved, and 80 of which had a location of tweet creation recorded (state and city). Next, user locations set as geographic coordinates were extracted as user geographic coordinates. Tweet locations and user locations that were assigned a state (Texas or Louisiana), but were not assigned a city, were removed from the dataset if a corresponding tweet or user geographic coordinate did not exist. Then, tweet locations that were assigned a city and state had their geographic coordinates imputed by assigning a random latitude and random longitude, bound between the respective city's most extreme border points, as identified by Google Maps. These imputed tweet location geographic coordinates were assigned as a tweet's coordinates if coordinates did not already exist from when the tweet was originally made. Following this, Google Maps was used to assess whether user geographic coordinates that had originally been set as the user location fell within Texas or Louisiana, and if not, these observations were deleted if a tweet geographic coordinate was not already assigned. User locations that were assigned a state and city then had their geographic coordinates imputed using the same method as tweet locations, and the user geographic coordinates from the original user location, as well as the imputed user location geographic coordinates, were assigned as a tweet's coordinates if coordinates were not already assigned. This process left a final sample size of 1,256, with each tweet having geographic coordinates and a city and state associated with it.

The above tweet geocoding methods primarily rely on the user location (entered once a user first start Twitter), rather than the location associated with an individual tweet, as most users turn the tweet location data off. In this case, however, these methods should be appropriate - as people who fled the impacted area before Hurricane Harvey hit will still have their user location linked to the impacted area.

```{r, echo=FALSE, results="hide", message=FALSE, warning=FALSE, include=FALSE}

# Now to start spatial statistics

# Loading in maps of Texas and Louisiana
statesmap <- map("state", c("TEXAS", "LOUISIANA"), fill=TRUE)

# Converting the map object of statesmap to Spatial Polygon objects
IDs <- sapply(strsplit(statesmap$names, ":"), function(x) x[1])
statespoly <- map2SpatialPolygons(statesmap, IDs=IDs, proj4string=CRS("+proj=longlat +datum=WGS84"))

# Projecting the spatial polygons to Lambert Cylindrical Equal Area, units Kilometers
statespoly <- spTransform(statespoly, CRS("+proj=cea +lon_0=-80 +datum=NAD27 +units=km"))

# Combining the Texas and Louisiana spatial polygons
statespoly <- gSimplify(statespoly, tol = 0.00001)
statespoly <- gBuffer(statespoly, byid=TRUE, width=0)
lps <- getSpPPolygonsLabptSlots(statespoly)
OneBin <- cut(lps[,1], range(lps[,1]), include.lowest=TRUE)
mergedstates <- unionSpatialPolygons(statespoly, OneBin)

# Extracting coordinates of the merged spatial polygon
x<-mergedstates@polygons[[1]]@Polygons
coords<-slot(x[[1]],"coords")
coords<-coords[1505:1,]
coords<-coords[-1,]

# Converting tweet coordinates to a Spatial Points Dataframe
final <- final[,c(1,2,4,3,5,6)]
tweetcoords <- final[,c(3,4)]
spdf <- SpatialPointsDataFrame(coords=tweetcoords, data=final, proj4string=CRS("+proj=longlat +datum=WGS84"))

# Projecting the spatial points dataframe to Lambert Cylindrical Equal Area, units meters
spdf <- spTransform(spdf, CRS("+proj=cea +lon_0=-80 +datum=NAD27 +units=m"))

# Converting the tweet coordinates to a ppp object, which is needed for the spatstat package, and performing conversion from meters to kilometers
regtweetdf <- as.data.frame(spdf)
colnames(regtweetdf)[7] <- c("longitude_m")
colnames(regtweetdf)[8] <- c("latitude_m")
tweetppp <- ppp(regtweetdf$longitude_m*0.001, regtweetdf$latitude_m*0.001, 
                window=owin(poly=list(x=coords[,1], y=coords[,2])))
# 29 points were rejected as lying outside the specified window, which is okay - possible that my imputation had some coordinate points fall in New Mexico and the Gulf of Mexico (especially for communities right on the coast)
tweetppp <- as.ppp(tweetppp)
summary(tweetppp)

# Estimating the optimal bandwidth for spatial intensity estimates
bw.diggle(tweetppp)
```

Spatial statistical analyses were performed with the assistance of the R packages maps (18), spatstat (19), splancs (20), maptools (21), rgeos (22), and rgdal (23). These analyses will be restricted to the spatial area of Texas and Louisiana, as this was the area most impacted by Hurricane Harvey. Maps of Texas and Louisiana were first loaded into R as map objects, and then converted to spatial polygon objects, projected as Lambert Cylindrical Equal Area using kilometers as the units, and merged to form one common spatial polygon. The Hurricane Harvey tweet coordinates were then converted to a spatial points dataframe, projected as Lambert Cylindrical Equal Area using meters as the units, and then transformed into a ppp object - necessary for spatial point pattern analyses with the spatstat package (19) - using the border coordinates of the common spatial polygon of Texas and Louisiana as a window, while applying an internal conversion to shift the units from meters to kilometers. During this process, 29 tweet coordinates were rejected as lying outside the specified window, which is okay - it is certainly possible that during the imputation of coordinates, some tweet locations were set to fall within New Mexico or the Gulf of Mexico - especially for cities right on the Texas coast.

Once data was set in the proper format, the spatial intensity of the collected Hurricane Harvey tweets was estimated using the kernel approach, with the bandwidth selected via the (1989) Berman and Diggle method (24), designed to minimize the mean squared error of the kernel smoothing estimator. Spatial intensity of point pattern data is simply the expected number of events in an area. The kernel approach estimates intensity by calculating the spatial intensity ($\lambda$) within a buffer around a given location ($s$), with the radius of the buffer being termed the bandwidth ($\tau$), and the entire intensity estimation being weighted by the distance event points are to the location of estimate ($s$) - with the weight estimator being termed the kernel ($\kappa$). This equation can be represented by: $$\hat{\lambda}(s) = \frac{1}{\delta(s)} \sum_{i=1}^{n} \frac{1}{\tau^2} \kappa \left(\frac{(s_i - s)}{\tau}\right)$$ where, in addition to the parameters listed above, $n$ is the number of events in a given area, $s_i$ designates an event, and $\delta(s)$ is an edge correction factor (25). 

Following the estimation of spatial intensity, the K-function for the Hurricane Harvey tweets was calculated. The K-function is a means of quantifying spatial clustering among point pattern data, which can be conceptualized by event locations occurring close to other events. The K-function can be defined as: $$\kappa(h) = \frac{E}{\lambda}$$ where $\kappa(h)$ is the K-function, reliant on distance ($h$), $E$ is the number of events within distance $h$ of an arbitrary event, and $\lambda$ is the spatial intensity, which for these purposed is assumed to be constant. In the case of the Hurricane Harvey tweets, the constant spatial intensity ($\lambda$), was calculated to be 0.001527626 expected tweets per kilometer. In practice, the K-function is estimated by: $$\hat{\kappa}(h) = (\hat{\lambda}^{-1}) (\frac{1}{n}) \sum_{i=1}^{n} \sum_{j\neq{i}} w_{ij}^{-1} I(d_{ij}\le{h})$$ where, in addition to the parameters listed above, $n$ is the number of events $i$, $j$ denotes any other point besides event $i$, $d_{ij}$ is the radius of a circle centered at point $s_i$ within the area of interest, $w_{ij}$ is a weight - defined as the proportion of circumference of the circle centered at point $s_i$ that falls within the area of interest, and $I()$ is the indicator function. The estimated K-function (y-axis) is plotted against distance (x-axis), and compared to the K-function expected under complete spatial randomness (CSR), where events occur independently of one another. An estimated K-function that is greater than the K-function expected under CSR suggests the presence of clustering (26).

Finally, in order to assist with interpretability, the estimated constant spatial intensity for the Hurricane Harvey tweets was multiplied by the estimated K-function in order to quantify the observed number of Hurricane Harvey tweets by distance, compared to the expected number of Hurricane Harvey tweets by distance under CSR (26).

***

**Results**

Figure creation was made possible through the use of the R packages ggplot2 (27), ggmap (28), gridExtra (29), and grid (30). Figure 1 presents the locations of tweets using the hashtag #HurricaneHarvey or #HurricaneHarveyRelief, collected between 9:10AM on September 1, 2017 and 9:56AM on September 4, 2017, with the tweet locations restricted to only those made in Texas or Louisiana. From this figure, it is clear that there are several pockets of high tweet density - primarily occurring around major cities, with notable clusters in Dallas, Austin, San Antonio, Houston, and New Orleans.

```{r, echo=FALSE, message=FALSE, warning=FALSE}

# Plotting all tweets together
Houston <- get_map(location="Houston", zoom=5, maptype="terrain", source="google", color="color")
Houston <- ggmap(Houston)
Houston_all <- Houston + geom_point(data = final, aes(x=longitude, y=latitude), color="RED", alpha=1/2, size=1)
Houston_all <- Houston_all + scale_x_continuous(limits=c(-107, -88)) + scale_y_continuous(limits=c(25, 37))
Houston_all <- Houston_all + labs(x = "Longitude", y = "Latitude", title = "Hurricane Harvey Tweet Locations, All Days of Collection", caption = "Figure 1: Locations of tweets made with #HurricaneHarvey or #HurricaneHarveyRelief, \ncollected between 9:10AM on 9/1/2017 and 9:56AM on 9/4/2017.") + theme(plot.title = element_text(hjust = 0.5)) + theme(plot.caption = element_text(hjust = 0.5)) + theme(axis.title = element_text(size=12))
Houston_all
```

From Table 1, it can be observed that more Hurricane Harvey tweets came out of Texas across all days of data collection as compared to Louisiana. The two most popular days of Hurricane Harvey tweeting were September 1st (N = 350 tweets) and September 2nd (N = 499 tweets), which intuitively makes sense, as these were the dates that were closest to the final landfall of the storm. It should be noted that the low tweet counts for September 4th should be interpreted with caution, as the Twitter live stream was ended on 9:56AM of that day. For an even more refined visualization of the Hurricane Harvey tweet locations by day, the geocoded tweets were stratified by day and are presented in figure S1 of the supplementary material.

Day of Tweet Creation | Texas | Louisiana
_____________________ | _____ | _________
september 1, 2017     | 335   | 15
September 2, 2017     | 473   | 26
September 3, 2017     | 315   | 16
September 4, 2017     | 71    | 5
All Days              | 1194  | 62
Table 1: Frequencies of Hurricane Harvey tweets, categorized by day and state of creation.

Figure 2 presents the results of the spatial intensity estimation of Hurricane Harvey tweets. With spatial intensity hotspots being marked by brighter, more yellow areas, it can be observed that there are defined areas of high spatial intensity around Dallas, Austin, San Antonio, and Houston, Texas. The spatial intensity of Hurricane Harvey tweets is by far the greatest around Houston, which is to be expected, as this was one of the areas worst impacted by the storm (31).

```{r, echo=FALSE, message=FALSE, warning=FALSE}

# Estimating and mapping the spatial intensity of tweets via the kernel approach, with the bandwith set at the optimal bandwith
Itweets <- density(tweetppp, 6.606245)
plot(Itweets, main="")
axis(side=2, at=c(2750, 3000, 3250, 3500, 3750))
mtext("Latitude (Km)", side=2, line=2.5)
axis(side=1, at=c(-3000, -2500, -2000, -1500, -1000), line=-0.5)
mtext("Longitude (Km)", side=1, line=1.5)
mtext("Figure 2: Spatial intensity of Hurricane Harvey tweets, calculated using kernel \nestimation with a bandwidth of 6.606245 kilometers.", side=1, line=4, cex=0.75)
polygon(coords,lwd=2)
```

Figures 3 and 4 display the results of the K-function calculation for Hurricane Harvey tweets. In Figure 3, the observed K-function for Hurricane Harvey tweets is clearly greater across all distances as compared to the K-function expected if the tweets were distributed with complete spatial randomness. This suggests that clustering is present in the Hurricane Harvey tweet data. Figure 4 presents the same graphical distribution as that in Figure 3 with an altered y-axis scale to assist with interpretability. From this figure, it can be seen that the observed number of tweets at every distance is far greater than the number expected under complete spatial randomness, indicating that event locations occur close to one another and there is clustering among the Hurricane Harvey tweets.

```{r, echo=FALSE, message=FALSE, warning=FALSE}

# Estimating and plotting the K-function for Hurricane Harvey Tweets
Ktweets <- Kest(tweetppp, correction="best")
plot(Ktweets$r, Ktweets$iso, lwd=2, main="", xlab="", ylab="", type="l")
lines(Ktweets$r, Ktweets$theo, lwd=2, col="blue", lty=3)
mtext("Distance (Km)", side=1, line=2)
mtext("Estimated K-Function", side=2, line=2.5)
title("K-Function for Hurricane Harvey Tweets", line=0.5)
mtext("Figure 3: Estimated K-function for Hurricane Harvey tweets, comparing the observed K of \ntweets (black) to the K that would be expected under complete spatial randomness (CSR; blue).", side=1, line=4, cex=0.75)
legend(10, 350000, legend=c("Observed K", "CSR K"), lty=c(1,3), col=c("black", "blue"),lwd=2)

# Estimating and plotting the clustering of Hurricane Harvey Tweets
plot(Ktweets$r,Ktweets$iso*0.001527626,lwd=2,xlab="", ylab="", main="",type="l")
lines(Ktweets$r,Ktweets$theo*0.001527626,lwd=2,col="blue",lty=3)
mtext("Distance (Km)", side=1, line=2)
mtext("Number of Tweets", side=2, line=2.5)
title("Clustering of Hurricane Harvey Tweets", line=0.5)
mtext("Figure 4: Observed number of Hurricane Harvey tweets (black), as compared to the number of \ntweets as would be expected under complete spatial randomness (CSR; blue).", side=1, line=4, cex=0.75)
legend(10, 575, legend=c("Observed # of Tweets", "Expected # of Tweets CSR"), lty=c(1,3), col=c("black", "blue"),lwd=2)
```

***

**Discussion**

This study examined the geospatial distribution of Texas and Louisiana tweets made with the hashtag #HurricaneHarvey and #HurricaneHarveyRelief in a short period immediately following landfall of the iconic storm. Results indicated that there was clustering among the Hurricane Harvey tweets, and that tweets occurred with the greatest intensity in Houston, Texas. These results suggest that social media data can be used as a tool to track and quantify the severity of a natural disaster in real-time. While this study possessed several strengths, it was not without its limitations and areas for improvement. Firstly, a sensitivity analysis could be performed in the future that assigns new random coordinates within the coordinate imputation procedure, and then observes whether the same spatial clustering and intensity results are obtained. Such an analysis would provide an indication as to the robustness of the spatial dependence within the Hurricane Harvey tweet data. Second, when the tweet coordinates were imputed, the city borders were treated as rectangles, which usually is not the case in reality. Future analyses could impute the coordinates with shapefiles of the city borders for more accurate estimates. Finally, a per-capita correction could be performed on the tweet data to help account for the fact that most of the identified areas of high spatial intensity occurred around cities, and it could be observed whether this has any influence on results.

***

**Supplementary Material**

```{r, echo=FALSE, message=FALSE, warning=FALSE}

# Separating out the tweets by days made
Sep_01 <- final[grep("Fri Sep 01", final$creation_time), ]
Sep_02 <- final[grep("Sat Sep 02", final$creation_time), ]
Sep_03 <- final[grep("Sun Sep 03", final$creation_time), ]
Sep_04 <- final[grep("Mon Sep 04", final$creation_time), ]

# Plotting tweets separated out by days
vplayout <- function(x, y) viewport(layout.pos.row = x, layout.pos.col = y)
grid.newpage()
pushViewport(viewport(layout = grid.layout(2,2)))

Houston_Sep01 <- Houston + geom_point(data = Sep_01, aes(x=longitude, y=latitude), color="RED", alpha=1/2, size=0.1)
Houston_Sep01 <- Houston_Sep01 + scale_x_continuous(limits=c(-107, -88)) + scale_y_continuous(limits=c(25, 37))
Houston_Sep01 <- Houston_Sep01 + labs(x = "", y = "Latitude", title = "September 1, 2017") + theme(plot.title = element_text(hjust = 0.5)) + theme(plot.title = element_text(size=9)) + theme(axis.title = element_text(size=7))
print(Houston_Sep01, vp=vplayout(1,1))

Houston_Sep02 <- Houston + geom_point(data = Sep_02, aes(x=longitude, y=latitude), color="RED", alpha=1/2, size=0.1)
Houston_Sep02 <- Houston_Sep02 + scale_x_continuous(limits=c(-107, -88)) + scale_y_continuous(limits=c(25, 37))
Houston_Sep02 <- Houston_Sep02 + labs(x = "", y = "", title = "September 2, 2017") + theme(plot.title = element_text(hjust = 0.5)) + theme(plot.title = element_text(size=9))
print(Houston_Sep02, vp=vplayout(1,2))

Houston_Sep03 <- Houston + geom_point(data = Sep_03, aes(x=longitude, y=latitude), color="RED", alpha=1/2, size=0.1)
Houston_Sep03 <- Houston_Sep03 + scale_x_continuous(limits=c(-107, -88)) + scale_y_continuous(limits=c(25, 37))
Houston_Sep03 <- Houston_Sep03 + labs(x = "Longitude", y = "Latitude", title = "September 3, 2017") + theme(plot.title = element_text(hjust = 0.5)) + theme(plot.title = element_text(size=9)) + theme(axis.title = element_text(size=7))
print(Houston_Sep03, vp=vplayout(2,1))

Houston_Sep04 <- Houston + geom_point(data = Sep_04, aes(x=longitude, y=latitude), color="RED", alpha=1/2, size=0.1)
Houston_Sep04 <- Houston_Sep04 + scale_x_continuous(limits=c(-107, -88)) + scale_y_continuous(limits=c(25, 37))
Houston_Sep04 <- Houston_Sep04 + labs(x = "Longitude", y = "", title = "September 4, 2017") + theme(plot.title = element_text(hjust = 0.5)) + theme(plot.title = element_text(size=9)) + theme(axis.title = element_text(size=7))
print(Houston_Sep04, vp=vplayout(2,2))
popViewport()
grid.text("S1: Hurricane Harvey tweet locations by day tweeted", x=unit(0.5, "npc"), y=unit(0.01, "npc"), gp=gpar(fontsize=7))
```

***

**References**

1: Ellison, N.B., Steinfield, C., & Lampe, C. (2007). The benefits of Facebook “friends:” Social capital and college students’ use of online social network sites. *Journal of Computer‐Mediated Communication*, 12(4), 1143-1168.

2: Chou, W.Y.S., Hunt, Y.M., Beckjord, E.B., Moser, R.P., & Hesse, B.W. (2009). Social media use in the United States: Implications for health communication. *Journal of Medical Internet Research*, 11(4), e48.

3: Rayat, A., Rayat, M., & Rayat, L. (2017). The impact of social media marketing on brand loyalty. *Annals of Applied Sport Science*, 5(1), 73-80.

4: Gao, H., Barbier, G., & Goolsby, R. (2011). Harnessing the crowdsourcing power of social media for disaster relief. *IEEE Intelligent Systems*, 26(3), 10-14.

5: Yin, J., Lampert, A., Cameron, M., Robinson, B., & Power, R. (2012). Using social media to enhance emergency situation awareness. *IEEE Intelligent Systems*, 27(6), 52-59.

6: Middleton, S.E., Middleton, L., & Modafferi, S. (2014). Real-time crisis mapping of natural disasters using social media. *IEEE Intelligent Systems*, 29(2), 9-17.

7: De Albuquerque, J.P., Herfort, B., Brenning, A., & Zipf, A. (2015). A geographic approach for combining social media and authoritative data towards identifying useful information for disaster management. *International Journal of Geographical Information Science*, 29(4), 667-689.

8: Kryvasheyeu, Y., Chen, H., Obradovich, N., Moro, E., Van Hentenryck, P., Fowler, J., & Cebrian, M. (2016). Rapid assessment of disaster damage using social media activity. *Science Advances*, 2(3), e1500779.

9: The Weather Channel. (2017). Historic Hurricane Harvey's Recap. https://weather.com/storms/hurricane/news/tropical-storm-harvey-forecast-texas-louisiana-arkansas [accessed October 15, 2017].

10: Brunila, M. (2017). Scraping, extracting and mapping geodata from Twitter. http://www.mikaelbrunila.fi/2017/03/27/scraping-extracting-mapping-geodata-twitter/ [accessed September 1, 2017].

11: Jeroen Ooms (2014). The jsonlite Package: A Practical and Consistent Mapping Between JSON Data and R Objects. arXiv:1403.2805 [stat.CO] URL https://arxiv.org/abs/1403.2805.

12: Karthik Ram and Clayton Yochum (2017). rdrop2: Programmatic Interface to the 'Dropbox' API. R package version 0.8.1. https://CRAN.R-project.org/package=rdrop2.

13: Kirill Müller and Hadley Wickham (2017). tibble: Simple Data Frames. R package version 1.3.4. https://CRAN.R-project.org/package=tibble.

14: Hadley Wickham, Romain Francois, Lionel Henry and Kirill Müller (2017). dplyr: A Grammar of Data Manipulation. R package version 0.7.4. https://CRAN.R-project.org/package=dplyr.

15: Hadley Wickham and Lionel Henry (2017). tidyr: Easily Tidy Data with 'spread()' and 'gather()' Functions. R package version 0.7.1. https://CRAN.R-project.org/package=tidyr.

16: Hadley Wickham (2017). stringr: Simple, Consistent Wrappers for Common String Operations. R package version 1.2.0. https://CRAN.R-project.org/package=stringr.

17: Matt Dowle and Arun Srinivasan (2017). data.table: Extension of `data.frame`. R package version 1.10.4. https://CRAN.R-project.org/package=data.table.

18: Original S code by Richard A. Becker, Allan R. Wilks. R version by Ray Brownrigg. Enhancements by Thomas P Minka and Alex Deckmyn. (2016). maps: Draw Geographical Maps. R package version 3.1.1. https://CRAN.R-project.org/package=maps.

19: Adrian Baddeley, Ege Rubak, Rolf Turner (2015). Spatial Point Patterns: Methodology and Applications with R. London: Chapman and Hall/CRC Press, 2015. URL http://www.crcpress.com/Spatial-Point-Patterns-Methodology-and-Applications-with-R/Baddeley-Rubak-Turner/9781482210200/.

20: Barry Rowlingson and Peter Diggle (2016). splancs: Spatial and Space-Time Point Pattern Analysis. R package version 2.01-39. https://CRAN.R-project.org/package=splancs.

21: Roger Bivand and Nicholas Lewin-Koh (2017). maptools: Tools for Reading and Handling Spatial Objects. R package version 0.8-41. https://CRAN.R-project.org/package=maptools.

22: Roger Bivand and Colin Rundel (2017). rgeos: Interface to Geometry Engine - Open Source (GEOS). R package version 0.3-23. https://CRAN.R-project.org/package=rgeos.

23: Roger Bivand, Tim Keitt and Barry Rowlingson (2017). rgdal: Bindings for the Geospatial Data Abstraction Library. R package version 1.2-6. https://CRAN.R-project.org/package=rgdal.

24: Berman, M. & Diggle, P. (1989) Estimating weighted integrals of the second-order intensity of a spatial point process. *Journal of the Royal Statistical Society, series B*, 51, 81-92.

25: Curriero, F. (2017). Statistical analysis of spatial point pattern data in public health. Lecture given on February 14, 2017, as a component of the Johns Hopkins Bloomberg School of Public Health course, Spatial Analysis III: Spatial Statistics.

26: Curriero, F. (2017). Statistical analysis of spatial point pattern data in public health. Lecture given on February 16, 2017, as a component of the Johns Hopkins Bloomberg School of Public Health course, Spatial Analysis III: Spatial Statistics.

27: H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2009.

28: D. Kahle and H. Wickham. ggmap: Spatial Visualization with ggplot2. The R Journal, 5(1), 144-161. URL http://journal.r-project.org/archive/2013-1/kahle-wickham.pdf.

29: Baptiste Auguie (2016). gridExtra: Miscellaneous Functions for "Grid" Graphics. R package version 2.2.1. https://CRAN.R-project.org/package=gridExtra.

30: R Core Team (2016). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.

31: Carlsen, A. & Lai, K.K.R. (2017). Where Harvey Hit Hardest Up and Down the Texas Coast. *The New York Times*. https://www.nytimes.com/interactive/2017/09/01/us/hurricane-harvey-damage-texas-cities-towns.html [accessed October 16, 2017].

```{r devtools, include=FALSE}
devtools::session_info()
```